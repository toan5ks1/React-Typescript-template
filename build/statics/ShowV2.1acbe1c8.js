var zt=Object.defineProperty,Tt=Object.defineProperties;var wt=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var De=(t,n,a)=>n in t?zt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,L=(t,n)=>{for(var a in n||(n={}))Fe.call(n,a)&&De(t,a,n[a]);if(j)for(var a of j(n))Ae.call(n,a)&&De(t,a,n[a]);return t},re=(t,n)=>Tt(t,wt(n));var M=(t,n)=>{var a={};for(var r in t)Fe.call(t,r)&&n.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&j)for(var r of j(t))n.indexOf(r)<0&&Ae.call(t,r)&&(a[r]=t[r]);return a};import{by as kt,bp as K,r as m,ic as W,R as e,ao as Ge,a8 as qe,id as Ot,aj as v,ie as Ut,de as je,eX as A,aS as x,dP as H,aK as k,d5 as We,c2 as fe,cq as Ee,cA as Pt,dc as Qt,hp as X,fm as Bt,ig as ze,cU as Mt,dq as ge,dr as he,eb as Ye,eL as Vt,eD as Rt,ek as ye,eT as ue,ih as $t,em as Je,cc as Nt,ch as Zt,aJ as D,aG as de,ct as Te,eQ as Ht,b9 as Ke,aH as Xe,e8 as Gt,ew as et,af as tt,hV as P,dQ as qt,db as jt,b8 as Wt,cK as Yt,ed as Jt,ii as w,eC as Kt,fN as we,cj as ke,ij as me,fJ as Xt,fH as Oe,fd as Ue,cR as en,ik as tn,i1 as nn,d0 as ee,g2 as an,il as rn,ab as on,d7 as sn,cL as oe,eS as nt,u as ln,N as cn,h_ as un,hf as dn,hu as mn,eV as at,ey as rt,ez as pn,hL as G,c8 as fn,im as En,ak as Pe,d6 as gn,c$ as se,cZ as hn,eq as yn,d8 as vn}from"./index.7daee9ef.js";import{A as _n,a as Cn,b as ot,t as xn,d as In,c as bn,u as Sn,D as Ln}from"./useSwapOrder.3f124831.js";import{B as Dn}from"./common.eab4c9d9.js";import{v as Q,w as R,x as O,r as F,u as N,E as Fn,F as pe,A as An,y as ie}from"./useShowSnackbar.da46e481.js";import{i as q}from"./infer-query.264ca744.js";import{d as zn,u as Tn,B as st,q as wn,Q as Qe,a as kn,b as On}from"./Delete.9e106999.js";import{I as J}from"./IconButtonBase.a835a6a3.js";import{u as Un,U as it}from"./UploadInput.4c4e4115.js";import{B as Pn}from"./BrightcoveLogoIcon.9d2bdc09.js";import{u as te}from"./useNavigation.f38e637f.js";import{u as lt}from"./useDialog.8ab3e0e0.js";import{u as Qn}from"./useBreadcrumbLOs.f7b6121c.js";import"./useNotifyForm.ee77e08e.js";import"./Draft.ec2d3075.js";import"./useSafeState.fc2ddfd3.js";import"./useMutationV2.0883e427.js";var ct=kt(K.exports.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"Image"),Bn=function(t){t===void 0&&(t={});var n=m.exports.useState(t),a=n[0],r=n[1],o=m.exports.useCallback(function(s){r(function(i){return Object.assign({},i,s instanceof Function?s(i):s)})},[]);return[a,o]},Mn=Bn;function Be(t){for(var n=[],a=0;a<t.length;a++)n.push({start:t.start(a),end:t.end(a)});return n}function Vn(t){return function(n){var a,r;m.exports.isValidElement(n)?(a=n,r=a.props):r=n;var o=Mn({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1,playing:!1}),s=o[0],i=o[1],c=m.exports.useRef(null),u=function(l,C){return function(S){try{C&&C(S)}finally{l&&l(S)}}},g=function(){return i({paused:!1})},E=function(){return i({playing:!0})},y=function(){return i({playing:!1})},f=function(){return i({paused:!0,playing:!1})},_=function(){var l=c.current;!l||i({muted:l.muted,volume:l.volume})},d=function(){var l=c.current;if(!!l){var C=l.duration,S=l.buffered;i({duration:C,buffered:Be(S)})}},p=function(){var l=c.current;!l||i({time:l.currentTime})},h=function(){var l=c.current;!l||i({buffered:Be(l.buffered)})};a?a=m.exports.cloneElement(a,W(W({controls:!1},r),{ref:c,onPlay:u(r.onPlay,g),onPlaying:u(r.onPlaying,E),onWaiting:u(r.onWaiting,y),onPause:u(r.onPause,f),onVolumeChange:u(r.onVolumeChange,_),onDurationChange:u(r.onDurationChange,d),onTimeUpdate:u(r.onTimeUpdate,p),onProgress:u(r.onProgress,h)})):a=m.exports.createElement(t,W(W({controls:!1},r),{ref:c,onPlay:u(r.onPlay,g),onPlaying:u(r.onPlaying,E),onWaiting:u(r.onWaiting,y),onPause:u(r.onPause,f),onVolumeChange:u(r.onVolumeChange,_),onDurationChange:u(r.onDurationChange,d),onTimeUpdate:u(r.onTimeUpdate,p),onProgress:u(r.onProgress,h)}));var I=!1,b={play:function(){var l=c.current;if(!!l&&!I){var C=l.play(),S=typeof C=="object";if(S){I=!0;var z=function(){I=!1};C.then(z,z)}return C}},pause:function(){var l=c.current;if(l&&!I)return l.pause()},seek:function(l){var C=c.current;!C||s.duration===void 0||(l=Math.min(s.duration,Math.max(0,l)),C.currentTime=l)},volume:function(l){var C=c.current;!C||(l=Math.min(1,Math.max(0,l)),C.volume=l,i({volume:l}))},mute:function(){var l=c.current;!l||(l.muted=!0)},unmute:function(){var l=c.current;!l||(l.muted=!1)}};return m.exports.useEffect(function(){var l=c.current;!l||(i({volume:l.volume,muted:l.muted,paused:l.paused}),r.autoPlay&&l.paused&&b.play())},[r.src]),[a,s,b,c]}}var Rn=Vn("audio"),$n=Rn,Nn=function(t){return(t+1)%1e6};function Zn(){var t=m.exports.useReducer(Nn,0),n=t[1];return n}const Hn=()=>e.createElement("svg",{width:"149",height:"180",viewBox:"0 0 149 180",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("path",{d:"M85.0872 135.135H24.3286C18.7363 135.135 14.2021 129.873 14.2021 123.384V11.7509C14.2021 5.26144 18.7363 0 24.3286 0H85.0872C90.6796 0 95.2137 5.26144 95.2137 11.7509V123.384C95.2137 129.873 90.6796 135.135 85.0872 135.135Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M96.9343 6.15421L96.2027 5.42578H95.1703H35.0243C27.0107 5.42578 20.4951 11.8978 20.4951 19.9032V133.689C20.4951 141.694 27.0107 148.166 35.0243 148.166H107.2C115.213 148.166 121.729 141.694 121.729 133.689V31.8806V30.8419L120.993 30.109L96.9343 6.15421Z",fill:"white",stroke:"#97C1FF",strokeWidth:"5"}),e.createElement("path",{d:"M122.089 30.9974H108.97C101.725 30.9974 95.8516 25.1488 95.8516 17.9352V4.87305L122.089 30.9974Z",fill:"#97C1FF"}),e.createElement("path",{d:"M72.479 48.9135H108.567C110.227 48.9135 111.574 47.572 111.574 45.9192C111.574 44.2663 110.227 42.9248 108.567 42.9248H72.479C70.8189 42.9248 69.4717 44.2663 69.4717 45.9192C69.4717 47.572 70.8189 48.9135 72.479 48.9135Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M54.435 61.7094H108.566C110.226 61.7094 111.574 60.3679 111.574 58.7151C111.574 57.0622 110.226 55.7207 108.566 55.7207H54.435C52.775 55.7207 51.4277 57.0622 51.4277 58.7151C51.4277 60.3679 52.775 61.7094 54.435 61.7094Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M54.435 74.5053H108.566C110.226 74.5053 111.574 73.1638 111.574 71.511C111.574 69.8581 110.226 68.5166 108.566 68.5166H54.435C52.775 68.5166 51.4277 69.8581 51.4277 71.511C51.4277 73.1638 52.775 74.5053 54.435 74.5053Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M54.435 87.3002H108.566C110.226 87.3002 111.574 85.9588 111.574 84.3059C111.574 82.653 110.226 81.3115 108.566 81.3115H54.435C52.775 81.3115 51.4277 82.653 51.4277 84.3059C51.4277 85.9588 52.775 87.3002 54.435 87.3002Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M54.435 100.085H108.566C110.226 100.085 111.574 98.7439 111.574 97.091C111.574 95.4382 110.226 94.0967 108.566 94.0967H54.435C52.775 94.0967 51.4277 95.4382 51.4277 97.091C51.4277 98.7439 52.775 100.085 54.435 100.085Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M54.435 112.881H79.9971C81.6571 112.881 83.0044 111.54 83.0044 109.887C83.0044 108.234 81.6571 106.893 79.9971 106.893H54.435C52.775 106.893 51.4277 108.234 51.4277 109.887C51.4277 111.54 52.775 112.881 54.435 112.881Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M110.306 154.946C121.932 154.946 131.357 145.562 131.357 133.986C131.357 122.41 121.932 113.025 110.306 113.025C98.6798 113.025 89.2549 122.41 89.2549 133.986C89.2549 145.562 98.6798 154.946 110.306 154.946Z",fill:"#97C1FF"}),e.createElement("path",{d:"M43.6143 83.1494H29.9447V47.0429H43.6143V83.1494Z",fill:"#9BC4F7"}),e.createElement("path",{d:"M36.7793 83.1494H29.9445V47.0429H36.7793V83.1494Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M36.7807 32.2305C34.8926 32.2305 33.3633 33.8877 33.3633 35.9337V39.6369H40.1981V35.9337C40.1981 33.8877 38.6688 32.2305 36.7807 32.2305Z",fill:"#73A0E0"}),e.createElement("path",{d:"M36.7807 32.2305C34.8926 32.2305 33.3633 33.8877 33.3633 35.9337V39.6369H36.7807V32.2305Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M29.9453 105.372L36.0693 115.326C36.4076 115.876 37.1526 115.876 37.4909 115.326L43.6149 105.372H29.9453Z",fill:"#D1DAFF"}),e.createElement("path",{d:"M35.0713 113.704L36.0692 115.326C36.4075 115.876 37.1525 115.876 37.4908 115.326L38.4887 113.704H35.0713Z",fill:"#55525B"}),e.createElement("path",{d:"M29.9453 83.1523H43.6149V105.372H29.9453V83.1523Z",fill:"#9BC4F7"}),e.createElement("path",{d:"M29.9453 83.1523H36.7801V105.372H29.9453V83.1523Z",fill:"#C0DDFF"}),e.createElement("path",{d:"M41.0518 39.6328H32.5084C31.0936 39.6328 29.9453 40.8771 29.9453 42.4102V47.0393H43.6149V42.4102C43.6149 40.8771 42.4666 39.6328 41.0518 39.6328Z",fill:"#82BBFF"}),e.createElement("path",{d:"M36.7801 39.6328H32.5084C31.0936 39.6328 29.9453 40.8771 29.9453 42.4102V47.0393H36.7801V39.6328Z",fill:"#82BBFF"}),e.createElement("ellipse",{cx:"74.5",cy:"170.5",rx:"74.5",ry:"9.5",fill:"#E1EDFA"}),e.createElement("path",{d:"M131.965 176.256C131.965 178.395 104.371 179.855 75.8296 179.855C47.2886 179.855 18.4737 178.654 18.4737 176.514C18.4737 174.375 47.2415 171.35 75.7825 171.35C104.324 171.35 131.965 174.117 131.965 176.256Z",fill:"#97C1FF"}),e.createElement("path",{d:"M114.44 131.558C114.61 130.482 113.516 129.765 112.948 129.541H107.62L108.898 131.334V131.558L106.554 141.421C105.872 144.29 106.98 145.157 107.62 145.231H113.161L111.882 143.662C112.664 140.076 114.269 132.634 114.44 131.558Z",fill:"white"}),e.createElement("circle",{cx:"111.5",cy:"125.5",r:"2.5",fill:"white"})),Gn=r=>{var o=r,{fill:t="#0B79D0",fillCircle:n="#2196F3"}=o,a=M(o,["fill","fillCircle"]);return e.createElement(Ge,L({},a),e.createElement("circle",{cx:"12",cy:"12",r:"12",fill:n,fillOpacity:"0.08"}),e.createElement("path",{d:"M16.6673 8.27337L15.7273 7.33337L12.0007 11.06L8.27398 7.33337L7.33398 8.27337L11.0607 12L7.33398 15.7267L8.27398 16.6667L12.0007 12.94L15.7273 16.6667L16.6673 15.7267L12.9407 12L16.6673 8.27337Z",fill:t}))},qn=t=>e.createElement(Ge,L({},t),e.createElement("circle",{cx:"12",cy:"12",r:"12",fill:"#EEEEEE"}),e.createElement("path",{d:"M15.7672 8.23329C14.8005 7.26663 13.4738 6.66663 12.0005 6.66663C9.05383 6.66663 6.67383 9.05329 6.67383 12C6.67383 14.9466 9.05383 17.3333 12.0005 17.3333C14.4872 17.3333 16.5605 15.6333 17.1538 13.3333H15.7672C15.2205 14.8866 13.7405 16 12.0005 16C9.79383 16 8.00049 14.2066 8.00049 12C8.00049 9.79329 9.79383 7.99996 12.0005 7.99996C13.1072 7.99996 14.0938 8.45996 14.8138 9.18663L12.6672 11.3333H17.3338V6.66663L15.7672 8.23329Z",fill:"black",fillOpacity:"0.54"})),jn=a=>{var r=a,{iconProps:t}=r,n=M(r,["iconProps"]);return e.createElement(J,L({color:"primary",size:"large"},n),e.createElement(zn,L({fontSize:"small"},t)))},Me=a=>{var r=a,{audioButtonProps:t}=r,n=M(r,["audioButtonProps"]);const[o,s,i]=$n(n),c=m.exports.useCallback(()=>{s.paused||i.seek(0),i.play()},[i,s.paused]);return e.createElement("div",{"data-testid":"AudioButtonPlayer__root"},o,e.createElement(jn,L({onClick:c,"data-testid":"AudioButtonPlayer__button"},t)))},Ve="AccordionSummaryBase",ut={root:`${Ve}-root`,colorDefault:`${Ve}-content`},Wn=qe(Ot)(({theme:t})=>({width:"100%",height:"100%",[`&.${ut.colorDefault}`]:{backgroundColor:t.palette.grey[100]}})),Re={fullWidth:{width:"100%",height:"100%"},delete:t=>{var n;return{cursor:"pointer",color:(n=t.palette.common)==null?void 0:n.white}}},dt=t=>{const E=t,{src:n,onDelete:a,shouldConfirmDelete:r,className:o,fullWidth:s=!0}=E,i=M(E,["src","onDelete","shouldConfirmDelete","className","fullWidth"]),[c,u]=m.exports.useState(!1),g=m.exports.useCallback(()=>{if(r){u(!0);return}a&&a()},[a,r]);return e.createElement(e.Fragment,null,e.createElement(v,L({position:"relative","data-testid":"ImagePreview__root",className:o,sx:L({},s&&Re.fullWidth)},i),e.createElement(Wn,{classes:{colorDefault:ut.colorDefault},src:n,variant:"rounded","data-testid":"ImagePreview__img"},e.createElement(ct,{"data-testid":"ImagePreview__default"})),a&&e.createElement(v,{sx:Re.delete,display:"inline-flex",position:"absolute",bottom:"7.5%",right:"7.5%"},e.createElement(Ut,{"data-testid":"ImagePreview__delete",onClick:g,color:"inherit"}))),r&&e.createElement(je,{open:c,onClose:()=>u(!1),onSave:a}))},Yn=t=>{const{onClick:n,identity:a,record:r,size:o="large",moveDownProps:s,moveUpProps:i,iconProps:c={}}=t;return e.createElement(e.Fragment,null,e.createElement(J,L({size:o,color:"primary",onClick:()=>n(A.MOVE_DOWN,a,r),"data-testid":"MoveUpDownBase__down"},s),e.createElement(_n,L({fontSize:"small"},c))),e.createElement(J,L({size:o,color:"primary",onClick:()=>n(A.MOVE_UP,a,r),"data-testid":"MoveUpDownBase__up"},i),e.createElement(Cn,L({fontSize:"small"},c))))},mt=()=>{const t=Q(),{mutate:n,isLoading:a}=R({entity:"quiz",action:"syllabusQuizSwapDisplayOrder"})({syllabusMigrationQuery:"default",onSuccess:()=>{t("ra.message.moveSuccess")},onError:r=>{O.warn("[useSwapQuizOrder]",r),t("ra.message.moveFail","error")}});return{updateOrder:n,isLoading:a}},Jn=t=>{const{loId:n,data:a,refetch:r,body:o}=t,s=F(),i=N(x.QUIZZES),{swap:c}=ot({data:a,key:"externalId"}),{updateOrder:u,isLoading:g}=mt(),E=m.exports.useCallback((d,p)=>{const h=c(d,p);if(h){const[I,b]=h;u({loId:n,pairsList:[{first:I.externalId,second:b.externalId}]},{onSuccess:()=>{r()}})}},[n,c,u,r]),y=a.length,f=m.exports.useCallback(d=>d===H.QuizItemAttributeConfig.FLASHCARD_LANGUAGE_CONFIG_ENG,[]),_=m.exports.useMemo(()=>[{key:"term",title:i("term"),cellProps:{style:{verticalAlign:"text-top"}},render:d=>{const p=f(d.termLanguage),h=p?1.25:0;return e.createElement(v,{display:"flex"},p&&e.createElement(v,{mr:1,"data-testid":"FlashcardTable__termAudio"},e.createElement(Me,{src:d.termAudio||""})),e.createElement(v,{mt:h},e.createElement(k,{variant:"body2"},d.term)))}},{key:"colDefinition",title:i("definition"),render:d=>{const p=f(d.definitionLanguage),h=p?1.25:0;return e.createElement(v,{display:"flex",justifyContent:"space-between"},e.createElement(v,{display:"flex",flex:1,mr:1},p&&e.createElement(v,{mr:1,"data-testid":"FlashcardTable__definitionAudio"},e.createElement(Me,{src:d.definitionAudio||""})),e.createElement(v,{mt:h},e.createElement(k,{variant:"body2"},d.definition))),e.createElement(v,{width:56,height:56,mt:h},e.createElement(dt,{src:d.image})))}},{key:"colActions",title:s("ra.common.actions"),render:(d,p)=>e.createElement(v,{gap:4},e.createElement(Yn,{moveDownProps:{disabled:g||p===y-1},moveUpProps:{disabled:g||p===0},identity:d.externalId,onClick:E})),cellProps:{style:{width:"12%",textAlign:"center"}}}],[s,g,i,y,E,f]);return e.createElement("div",{"data-testid":"FlashcardTable__root"},e.createElement(We,{body:o,data:a,columns:_,withIndex:{width:"5%"},tableProps:{sx:{"[class*='MuiTableCell-root']":{verticalAlign:"text-top"}}}}))},Kn=t=>{const{children:n}=t,r=fe()("ra.common.action.addMore");return e.createElement(Ee,L({"aria-label":r,startIcon:e.createElement(Pt,null),variant:"outlined"},t),n||r)},Xn=t=>{const{children:n,footer:a}=t;return e.createElement(v,{px:4,py:3},n,e.createElement(v,{pt:3,pb:2},e.createElement(Qt,null)),e.createElement(v,{display:"flex",justifyContent:"center"},a))},ve=H.QuizItemAttributeConfig.FLASHCARD_LANGUAGE_CONFIG_ENG,_e=H.QuizItemAttributeConfig.FLASHCARD_LANGUAGE_CONFIG_JP,ea=t=>{const{loId:n,quizId:a,externalId:r,schoolId:o,difficultyLevel:s,image:i,term:c,definition:u,definitionLanguage:g=ve,termLanguage:E=_e,termAudio:y,definitionAudio:f}=t,_=new Map,d=Bt(),p={configs:[],rects:[],correct:!0,groupKey:d,content:ze(c||""),id:d,label:"",attribute:{imgLink:"",audioLink:y,configs:[E]}};return _.set(d,p),{quizId:a,loId:n,externalId:r,schoolId:o,difficultyLevel:s,kind:X.QuizType.QUIZ_TYPE_POW,explanation:{content:Mt.EditorState.createEmpty(),rects:[]},question:{content:ze(u||""),rects:[]},answer:{configs:[],labelType:null,list:_},attribute:{imgLink:i||"",audioLink:f,configs:[g]}}},ta=(t,n)=>{let a;const{question:r,answer:o,difficultyLevel:s,schoolId:i,quizId:c,externalId:u,attribute:g={configs:[],imgLink:void 0,audioLink:void 0}}=t;try{const E=r.content.getCurrentContent().getPlainText(),y=Array.from(o.list.values())[0],{content:f,attribute:_={configs:[]}}=y,d=f.getCurrentContent().getPlainText(),{imgLink:p,audioLink:h,configs:I}=g;a={difficultyLevel:s,schoolId:i,quizId:c,externalId:u,loId:n,image:p,kind:X.QuizType.QUIZ_TYPE_POW,term:d,definition:E,termLanguage:_.configs[0]||ve,definitionLanguage:I[0]||_e,termAudio:_.audioLink,definitionAudio:h}}catch(E){O.warn("[convertQuizToFlashcard]",E)}return a},na=()=>{const t=m.exports.useCallback(({schoolId:a,loId:r})=>{const o=Fn({schoolId:a,kind:X.QuizType.QUIZ_TYPE_POW,loId:r,isLo:!1});return re(L({},o),{term:"",definition:"",draft:!0,termLanguage:ve,definitionLanguage:_e})},[]);return{convertQuizToArrayForm:m.exports.useCallback((a,r)=>{const o=a.map(i=>pe(i,r)),s=[];return o.forEach(i=>{const c=ta(i,r);c&&s.push(c)}),s},[]),createEmptyFlashcard:t}};var Ce={},aa=he.exports;Object.defineProperty(Ce,"__esModule",{value:!0});var pt=Ce.default=void 0,ra=aa(ge),oa=K.exports,sa=(0,ra.default)((0,oa.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");pt=Ce.default=sa;const ia=t=>{const{children:n,index:a,actions:r,onDelete:o}=t;return e.createElement(Ye,{"data-testid":"PaperBulkActions__root"},e.createElement(v,{display:"flex",justifyContent:"space-between",alignItems:"center",px:3,py:1.5,height:56},e.createElement(k,{component:"span",variant:"body1",color:"textPrimary"},a),e.createElement(v,null,r,o&&e.createElement(v,{ml:1},e.createElement(J,{size:"large",sx:{width:40,height:40},onClick:o,"data-testid":"PaperBulkActions__delete"},e.createElement(pt,{fontSize:"small"}))))),e.createElement(Vt,null),e.createElement(v,{p:2},n))},$e={upload:t=>({border:`1px dashed ${t.palette.primary.border}`,backgroundColor:t.palette.primary.background}),pointer:{cursor:"pointer"}},ft=t=>{const{defaultValue:n,onChange:a,onRemove:r,maxSize:o,disabled:s,shouldConfirmDelete:i}=t,c=fe(),{size:u,unit:g}=Je(o),[E,y]=m.exports.useState(n),{onDropRejected:f,onUploadFiles:_,isUploading:d}=Un(o),{getRootProps:p,getInputProps:h}=Rt({multiple:!1,maxSize:o,accept:ye.IMAGE,disabled:s||d,onDropRejected:f,onDropAccepted:l=>{_(l,{onSuccess:({attachments:C})=>{const S=C[0].resource;y(S),a(S)}})}}),I=m.exports.useCallback(()=>{r(),y(void 0)},[r]),b=96;return E?e.createElement(dt,{src:E,onDelete:I,shouldConfirmDelete:i,width:b,height:b,fullWidth:!1}):e.createElement(v,{display:"flex",flexDirection:"column"},e.createElement(v,re(L({},p()),{borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",sx:$e.upload,width:b,height:b}),e.createElement("input",L({},h())),d?e.createElement(ue,null):e.createElement(v,{sx:$e.pointer},e.createElement(v,{display:"flex",justifyContent:"center",alignItems:"center"},e.createElement(ct,{fontSize:"medium",color:"primary"})),e.createElement(v,{mt:.5,px:1.5,textAlign:"center"},e.createElement(k,{variant:"caption",color:"textSecondary"},c("ra.upload.uploadImage"))))),e.createElement(v,{mt:.5,display:"inline"},e.createElement(k,{variant:"caption",color:"textSecondary"},c("ra.input.file.maxSize",{fileSize:u,fileUnit:g}))))};ft.defaultProps={maxSize:$t};const la=Nt({en:H.QuizItemAttributeConfig.FLASHCARD_LANGUAGE_CONFIG_ENG,ja:H.QuizItemAttributeConfig.FLASHCARD_LANGUAGE_CONFIG_JP},"flashcardLanguage",x.QUIZZES),ca=t=>{const{keyPath:n,defaultValues:a}=t,r=F(),{setValue:o}=Zt(),s=N(x.QUIZZES),i=xn(la,r),c=typeof n!="undefined"?n:"";return e.createElement(D,{container:!0,alignItems:"start"},e.createElement(D,{container:!0,item:!0,xs:11,margin:-1},e.createElement(D,{item:!0,xs:6,p:1},e.createElement(de,{name:`${c}term`,label:s("term"),required:!0,rules:{required:{value:!0,message:r("resources.input.error.fieldCannotBeBlank",{field:s("term")})}},defaultValue:a.term})),e.createElement(D,{item:!0,xs:6,p:1},e.createElement(de,{name:`${c}definition`,label:s("definition"),required:!0,rules:{required:{value:!0,message:r("resources.input.error.fieldCannotBeBlank",{field:s("definition")})}},defaultValue:a.definition})),e.createElement(D,{container:!0,item:!0,xs:6,p:1},e.createElement(D,{item:!0,xs:5},e.createElement(Te,{label:s("flashcard.termLanguage"),name:`${c}termLanguage`,options:i,defaultValue:a.termLanguage}))),e.createElement(D,{container:!0,item:!0,xs:6,p:1},e.createElement(D,{item:!0,xs:5},e.createElement(Te,{label:s("flashcard.definitionLanguage"),name:`${c}definitionLanguage`,options:i,defaultValue:a.definitionLanguage})))),e.createElement(D,{item:!0,xs:1,flexGrow:"1 !important",maxWidth:"100% !important"},e.createElement(v,{display:"flex",flexDirection:"row-reverse",height:"100%"},e.createElement(ft,{defaultValue:a.image,onChange:u=>{o(`${c}image`,u)},onRemove:()=>{o(`${c}image`,void 0)}}))))},ua=t=>{const{loId:n,defaultValues:a,onDeleteSuccess:r,index:o}=t,s=N(x.QUIZZES),i=F(),c=Q(),{mutate:u,isLoading:g}=R({entity:"quiz",action:"syllabusQuizDelete"})({syllabusMigrationQuery:"default"}),[E,y]=m.exports.useState(!1),f=d=>{c(s("flashcard.deleteSuccess")),r(d)},_=(d,p)=>{if(d.draft)return f(p);u({loId:n,quizId:d.externalId},{onSuccess:()=>{f(p)},onError:h=>{O.warn("[FlashCardFormWithBulkActions]",h),c("ra.common.deleteFail","error")}})};return e.createElement(v,{"data-testid":"FlashCardFormWithBulkActions__root"},e.createElement(ia,{index:o+1,onDelete:()=>y(!0)},e.createElement(ca,{keyPath:`flashcards.${o}.`,defaultValues:a})),e.createElement(je,{open:E,onClose:()=>y(!1),onSave:()=>_(a,o),title:s("flashcard.deleteCard"),footerConfirmButtonProps:{disabled:g},textCancelDialog:e.createElement(e.Fragment,null,e.createElement(Ht,{component:"span"},s("flashcard.cardIndex",{index:o.toString.length<2?`0${o+1}`:o+1})),e.createElement(Ke,{component:"span"},i("ra.common.deleteConfirmText",{smart_count:2})))}))},da=t=>{const{defaultValues:n,loId:a,open:r,onClose:o,createEmptyFlashcard:s,onSuccess:i}=t,[c,u]=m.exports.useState(!1),g=F(),E=N(x.QUIZZES),y=Q(),f=Xe({defaultValues:n}),{control:_,handleSubmit:d}=f,{fields:p,append:h,remove:I}=Gt({control:_,name:"flashcards"}),{mutate:b,isLoading:l}=R({entity:"quiz",action:"QUIZ_UPSERT_V2"})({syllabusMigrationQuery:"default"}),C=({flashcards:T})=>{const V=T.map(ea),ne={kind:H.QuizType.QUIZ_TYPE_POW,quizList:V};b(ne,{onSuccess:()=>{y(E("flashcard.addSuccess")),i()},onError:ae=>{O.warn("[FlashcardUpsertDialog]",ae),y("ra.common.addedFail","error")}})},S=()=>{const T=s();h(T)},z=(T,V)=>{I(T),!c&&!V&&u(!0)},B=m.exports.useCallback(()=>{o(c)},[o,c]),U=l||!p.length;return e.createElement(et,{methods:f,open:r,onClose:B,title:`${g("ra.common.action.add")}/${g("ra.common.action.edit")}`,onSave:d(C),footerConfirmButtonProps:{disabled:U}},e.createElement(Ye,{elevation:2},e.createElement(Xn,{footer:e.createElement(Kn,{onClick:S})},p.map((T,V)=>e.createElement(v,{key:T.id,mt:3},e.createElement(ua,{loId:a,index:V,defaultValues:T,onDeleteSuccess:()=>z(V,T.draft)}))))),l&&e.createElement(v,{"data-testid":"FlashcardUpsertDialog__saving",mt:3},e.createElement(tt,null)))},ma=t=>{const n=fe(),a=`${n("ra.common.action.add")}/${n("ra.common.action.edit")}`;return e.createElement(Ee,L({"aria-label":a,"data-testid":"ButtonUpsert__root"},t),a)},pa=({loId:t})=>{const{isLoading:n,data:a,isFetching:r,refetch:o}=q({entity:"quizzes",action:"syllabusQuizGetManyByLOId"})({lo_id:t},{enabled:!0});return{isLoading:n,data:a,refetch:o,isFetching:r}},fa=t=>{const{record:n}=t,{lo_id:a,school_id:r}=n,[o,s]=m.exports.useState(!1),i=N(x.LOS),{data:c=[],isLoading:u,isFetching:g,refetch:E}=pa({loId:a}),{convertQuizToArrayForm:y,createEmptyFlashcard:f}=na(),_=m.exports.useCallback(()=>f({schoolId:r,loId:a}),[f,a,r]),d=m.exports.useCallback(I=>{I&&E(),s(!1)},[E]),p=m.exports.useMemo(()=>y(c,a),[c,y,a]),h=m.exports.useMemo(()=>p.length?p:[...Array(5).keys()].map(()=>_()),[_,p]);return e.createElement("div",{"data-testid":"FlashcardV2__show"},e.createElement(v,{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},e.createElement(k,{color:"textPrimary"},i("cardListing")),e.createElement(ma,{disabled:u,onClick:()=>s(!0)})),e.createElement(Jn,{loId:a,data:p,refetch:E,body:{loading:u||g,rowKey:"externalId"}}),o&&e.createElement(da,{open:o,onClose:d,onSuccess:()=>{E(),s(!1)},defaultValues:{flashcards:h},loId:a,createEmptyFlashcard:_}))},Ne={[P.LEARNING_OBJECTIVE_TYPE_FLASH_CARD]:"flashCard",[P.LEARNING_OBJECTIVE_TYPE_OFFLINE_LEARNING]:"offlineStudy",[P.LEARNING_OBJECTIVE_TYPE_LEARNING]:"learningObjective"},Ea=t=>{const{open:n,onClose:a,onSave:r,defaultValues:o}=t,s=Q(),i=N(x.LOS),c=F(),u=Xe({defaultValues:o,mode:"all"}),{handleSubmit:g}=u,{mutate:E}=R({entity:"learningObjective",action:"syllabusLOUpsert"})({syllabusMigrationQuery:"default",onSuccess:()=>{s(c("ra.common.updatedSuccess",{smart_count:c(`resources.topics.${Ne[t.defaultValues.type]}`)},{lowercase:!0})),r==null||r()},onError:f=>{O.warn("onError upsertLOs",f);const _=qt(f);s(c(_.message),"error")}}),y=async f=>{const{lo_id:_,school_id:d,topic_id:p,name:h,type:I,display_order:b,prerequisites:l,study_guide:C,video:S}=f,z={loId:_,schoolId:d,topicId:p,name:h,type:I,displayOrder:Number(b),prerequisitesList:l,studyGuide:C||void 0,video:S||void 0};E(z)};return e.createElement(et,{title:i("editTitle"),open:n,onClose:a,onSave:g(y),methods:u},e.createElement(jt,null,e.createElement(de,{inputProps:{"data-testid":"LODialog__inputName"},required:!0,label:c(`resources.topics.${Ne[t.defaultValues.type]}`),autoFocus:!0,name:"name"})))},Et=a=>{var r=a,{disable:t}=r,n=M(r,["disable"]);const o=F();return e.createElement(Wt,L({title:o("ra.common.deleteDialogTitle",{smart_count:o(`resources.${x.QUIZZES}.question`)}),textSave:o("ra.common.action.delete"),footerConfirmButtonProps:{color:"error",variant:"contained",disabled:t}},n),e.createElement(Ke,{variant:"body2"},o(`resources.${x.QUIZZES}.dialogDeleteConfirm`)))},ga=({text:t})=>e.createElement(v,{component:"div",display:"flex",alignItems:"center",justifyContent:"center","data-testid":"DividerWithText_container"},e.createElement(v,{component:"hr",flex:1,height:"1px",border:"none",bgcolor:"#E0E0E0","data-testid":"DividerWithText__hr"}),e.createElement(v,{component:"span",my:0,mx:1.5,color:"#757575","data-testid":"DividerWithText__text"},t),e.createElement(v,{component:"hr",flex:1,height:"1px",border:"none",bgcolor:"#E0E0E0","data-testid":"DividerWithText__hr"})),gt=t=>t?t.replace(/^\s*[\r\n]/gm,"").trim().split(`
`).map(n=>n.match(/\d{13}/gm)||[""]).map(n=>({accountId:n[0],videoId:n[1]})):[],Ze=(t,n)=>{const a=gt(t);return a.length?a.every(r=>r.videoId&&r.accountId===n):!1};function xe(){const{data:t={accountId:"",policyKey:""}}=q({entity:"brightcove",action:"BRIGHTCOVE_GET_PROFILE"})(void 0,{enabled:!0});return t}const le={title:t=>({paddingBottom:t.spacing(1)}),input:t=>({margin:t.spacing(0,1)}),button:{whiteSpace:"nowrap"}},ha=({onChange:t})=>{const n=F(),{accountId:a}=xe(),[r,o]=m.exports.useState(""),[s,i]=m.exports.useState(""),c=m.exports.useCallback(()=>{t(gt(r)),o("")},[r,t,o]),u=({target:{value:g}})=>{if(o(g),!g||Ze(g,a)){i("");return}i(n("ra.message.uploadBrightcoveLinkFail"))};return e.createElement("div",{"data-testid":"BrightCoveUpload"},e.createElement(Yt,{sx:le.title,variant:"subtitle2"},n("resources.input.pasteVideoLink")),e.createElement(v,{display:"flex",flexDirection:"row",alignItems:"flex-start"},e.createElement(v,{display:"flex"},e.createElement(Pn,null)),e.createElement(Jt,{name:"url",sx:le.input,size:"small",margin:"none",label:n(`resources.${x.LOS}.brightcoveVideoLink`),value:r,error:!!s,helperText:s,onChange:u,"data-testid":"BrightCoveUpload__input"}),e.createElement(Ee,{sx:le.button,disabled:!Ze(r,a),"aria-label":n("ra.common.action.upload"),onClick:c,"data-testid":"BrightCoveUpload_button"},n("ra.common.action.upload"))))},Z={loadingContainer:{display:"flex",alignItem:"center",padding:"10px 0px"},loadingText:{flex:"1"},stateIcon:{cursor:"pointer",marginLeft:"5px"},failedText:t=>({flex:"1",color:t.palette.error.main}),fileName:{fontWeight:"bold"}},ya=({state:t,files:n,onRetry:a,onDelete:r})=>{const o=N("input");return e.createElement("div",null,e.createElement(v,{sx:Z.loadingContainer},t==w.LOADING&&e.createElement(v,{component:"span","data-testid":"UploadingState__loadingText",sx:Z.loadingText},o("uploading")),t==w.FAILED&&e.createElement(e.Fragment,null,e.createElement(v,{component:"span","data-testid":"UploadingState__failedText",sx:Z.failedText},o("cannotUpload")),e.createElement(qn,{"data-testid":"UploadingState__retryIcon",sx:Z.stateIcon,onClick:a})),e.createElement(Gn,{"data-testid":"UploadingState__deleteIcon",onClick:r,sx:Z.stateIcon})),t==w.LOADING&&e.createElement(tt,{"data-testid":"UploadingState__linearProgress"}),t==w.FAILED&&(n==null?void 0:n.map((s,i)=>e.createElement(v,{"data-testid":"UploadingState__filename",key:i,sx:Z.fileName},s.name))))},va=()=>{const t=Q(),n=F();return R({entity:"media",action:"MEDIA_UPLOAD_VIDEO"})({onError:a=>{O.warn("[useUploadBrightcove]",a),t(`${n("ra.manabie-error.cannotUpload")}: ${a.message}`,"error")}})},_a=r=>{var o=r,{onChange:t,children:n}=o,a=M(o,["onChange","children"]);const s=F(),{size:i,unit:c}=Je(we),{mutateAsync:u}=va(),{accountId:g}=xe(),[E,y]=m.exports.useState([]),f=m.exports.useRef(w.DEFAULT),_=Zn(),d=Q(),p=m.exports.useCallback(l=>{f.current=l,_()},[f,_]),h=m.exports.useCallback(async l=>{if(!(l.length===0||!t)){y(l),p(w.LOADING);try{const C=await u(l);f.current!==w.DEFAULT&&(t(C.map(({videoId:S})=>({videoId:S,accountId:g}))),p(w.DEFAULT))}catch{p(w.FAILED),d(s("ra.manabie-error.cannotUpload"),Kt.ERROR)}}},[t,p,u,g,d,s]),I=m.exports.useCallback(()=>h(E),[h,E]),b=m.exports.useCallback(()=>{y([]),p(w.DEFAULT)},[p,y]);return e.createElement(e.Fragment,null,f.current==w.DEFAULT&&e.createElement("div",null,e.createElement(it,L({multiple:!0,source:"files",accept:[ye.VIDEO],maxSize:we,description:s("ra.message.maxFileSizeIs",{fileSize:i,fileUnit:c}),customUploadFn:h},a),n),e.createElement(ga,{text:s("ra.upload.or")}),e.createElement(ha,{onChange:t})),f.current!==w.DEFAULT&&e.createElement(ya,{onRetry:I,onDelete:b,state:f.current,files:E}))},He={wrapper:t=>({padding:t.spacing(3,4),marginBottom:t.spacing(2)}),attachmentDeleteIcon:t=>({width:t.spacing(1.75),height:t.spacing(1.75),color:t.palette.text.light,margin:0}),divider:t=>({margin:t.spacing("3px",0,"3px","-1px")})},Ca=t=>{const n=F(),a=Q(),p=t,{studyGuide:r,videoId:o,onChangeAttachment:s,isLoadingFile:i}=p,c=M(p,["studyGuide","videoId","onChangeAttachment","isLoadingFile"]),{onUploadFiles:u}=Tn(),{accountId:g}=xe(),{data:E,isLoading:y,error:f}=q({entity:"brightcove",action:"syllabusBrightcoveGetVideoInfo"})({accountId:g,videoId:o},{enabled:Boolean(o&&g),onError:h=>{h.message==="ra.manabie-error.specified.brightcoveVideoIsBeingProcessed"?a(n(h.message),"info"):(O.warn("[AttachmentSection]  fetching video info for LO",h),a(h.message,"error"))}}),_=m.exports.useCallback(async h=>{u(h,{onSuccess:({attachments:I})=>{const b=I.map(l=>l.resource);s({type:"study_guide",studyGuideUrl:ke(b)||""})}})},[s,u]),d=()=>i?e.createElement(ue,null):r?e.createElement(Oe,{name:r,href:r,type:Ue.MEDIA_TYPE_PDF,onDelete:()=>s({type:"study_guide",studyGuideUrl:""})}):e.createElement(it,{accept:ye.PDF,multiple:!1,maxSize:nn,"data-testid":"Attachment__studyGuide",customUploadFn:_});return e.createElement(st,{sx:He.wrapper,"data-testid":"AttachmentSection__root"},e.createElement(D,L({container:!0},c),e.createElement(D,{item:!0,xs:6,pr:3},e.createElement(me,{spacing:24},e.createElement(k,{gutterBottom:!1,variant:"h6"},n(`resources.${x.LOS}.video`)),o?E?e.createElement(Xt,{videoId:o},e.createElement(Oe,{name:E.name||n(`resources.${x.LOS}.viewCurrentVideo`),type:Ue.MEDIA_TYPE_VIDEO,onDelete:()=>s({type:"video",video:{videoId:"",accountId:""}})})):y?e.createElement(ue,null):n(en(f==null?void 0:f.message)):e.createElement(_a,{onChange:h=>{s({type:"video",video:ke(h)})}}))),e.createElement(tn,{sx:He.divider,orientation:"vertical",flexItem:!0}),e.createElement(D,{item:!0,xs:6,pl:3},e.createElement(me,{spacing:24},e.createElement(k,{gutterBottom:!1,variant:"h6"},n(`resources.${x.LOS}.studyGuide`)),d()))))},xa=t=>{const{searchURL:n=""}=t,a=F(),r=te(),o=m.exports.useCallback(()=>{r.push(`/${ee.SYLLABUS}/${x.QUIZZES}/create${n}`)},[r,n]);return e.createElement(an,{onClick:o},a("ra.common.action.add"))},Ia={color:"red"},ba=()=>{const t=F();return e.createElement("div",{style:Ia},t("ra.manabie-error.not_found"))},Sa=t=>{const{url:n,maxHeight:a}=t,[r,o]=m.exports.useState(null),[s,i]=m.exports.useState(!0);return m.exports.useEffect(()=>{if(!n)return;let c=!1;return rn.get(n,{headers:{"Content-Type":"text/html"}}).then(u=>{c||o(on.forDOM(u.data))}).catch(u=>{O.warn("Cannot fetch question content",u)}).finally(()=>{i(!1)}),()=>{c=!0}},[n]),s?e.createElement(sn,{size:24}):r?e.createElement(v,{sx:{maxHeight:a,overflow:"hidden"},dangerouslySetInnerHTML:{__html:r}}):e.createElement(ba,null)};var Ie={},La=he.exports;Object.defineProperty(Ie,"__esModule",{value:!0});var ht=Ie.default=void 0,Da=La(ge),Fa=K.exports,Aa=(0,Da.default)((0,Fa.jsx)("path",{d:"M18 13v7H4V6h5.02c.05-.71.22-1.38.48-2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-5l-2-2zm-1.5 5h-11l2.75-3.53 1.96 2.36 2.75-3.54L16.5 18zm2.8-9.11c.44-.7.7-1.51.7-2.39C20 4.01 17.99 2 15.5 2S11 4.01 11 6.5s2.01 4.5 4.49 4.5c.88 0 1.7-.26 2.39-.7L21 13.42 22.42 12 19.3 8.89zM15.5 9C14.12 9 13 7.88 13 6.5S14.12 4 15.5 4 18 5.12 18 6.5 16.88 9 15.5 9z"}),"ImageSearchOutlined");ht=Ie.default=Aa;const za=t=>{const{record:n,index:a,size:r,onAction:o,onReOrder:s,onSetQuizReview:i}=t,{open:c,onClose:u,onOpen:g}=lt(!1),E=a===r-1,y=a===0,f=[A.EDIT,{action:A.DELETE,onClick:g,render:_=>e.createElement("span",null,_)}];return e.createElement(e.Fragment,null,e.createElement(D,{container:!0,wrap:"nowrap",alignItems:"center"},e.createElement(D,{item:!0},e.createElement(oe,{color:"primary",onClick:i,"data-testid":"QuizTable__previewButton",size:"large"},e.createElement(ht,null))),e.createElement(D,{item:!0},e.createElement(oe,{color:"primary",disabled:E,onClick:()=>s(A.MOVE_DOWN,n.quiz_id),"data-testid":"QuizTable__moveDownButton",size:"large"},e.createElement(In,null))),e.createElement(D,{item:!0},e.createElement(oe,{color:"primary",disabled:y,onClick:()=>s(A.MOVE_UP,n.quiz_id),"data-testid":"QuizTable__moveUpButton",size:"large"},e.createElement(bn,null))),e.createElement(D,{item:!0},e.createElement(nt,{record:n,recordName:"",onAction:o,actions:f}))),e.createElement(Et,{open:c,onClose:u,onSave:()=>o(A.DELETE,n)}))};function yt(){const t=ln(),n=cn(wn),a=m.exports.useCallback(o=>{t(Qe.setQuizOnReview(o))},[t]),r=m.exports.useCallback(()=>{t(Qe.setQuizOnReview(null))},[t]);return{quizOnReview:n,onSetQuizReview:a,onCloseReview:r}}const Y={idColumn:{width:"15%"},typeColumn:{width:"15%"},actionColumn:{width:"1%",whiteSpace:"nowrap",textAlign:"center"},table:{"& tbody tr":{verticalAlign:"baseline"}}},Ta=t=>{const{quizzes:n,loId:a,searchURL:r,loading:o,refetchQuizzes:s}=t,i=F(),c=n?n.length:0,u=un(x.QUIZZES),{onSetQuizReview:g}=yt(),E=te(),y=Q(),{updateOrder:f,isLoading:_}=mt(),{swap:d}=ot({data:n,key:dn[x.QUIZZES]}),p=m.exports.useCallback(async(l,C)=>{const S=d(l,C);(!S||S.length<2)&&O.error("[Quiz re-order]: cannot swap arr",l,C);const[z,B]=S;f({loId:a,pairsList:[{first:z.external_id,second:B.external_id}]},{onSuccess:()=>{s()}})},[d,f,a,s]),{mutate:h}=R({entity:"quiz",action:"syllabusQuizDelete"})({syllabusMigrationQuery:"default",onSuccess:()=>{y(i("ra.common.deleteSuccess",{smart_count:i(`resources.${x.QUIZZES}.question`)},{lowercase:!0})),s()},onError:l=>{O.warn("[QuizTable delete quiz]",l),y(`${i("ra.common.deleteFail")}: ${l.message}`,"error")}}),I=m.exports.useCallback((l,C)=>{switch(l){case A.EDIT:return E.push(`/${ee.SYLLABUS}/${x.QUIZZES}/${C.quiz_id}/edit${r}`);case A.DELETE:return h({quizId:C.external_id,loId:a})}},[E,r,h,a]),b=m.exports.useMemo(()=>[...mn.can("quizzes","show.external_id")?[{cellProps:{sx:Y.idColumn},title:i(`resources.${x.QUIZZES}.mappedID`),render:l=>e.createElement(k,{display:"inline",variant:"body2",color:"primary",style:{cursor:"pointer"},onClick:()=>g(pe(l,a)),"data-testid":"QuizTable__id"},l.external_id),key:"externalID"}]:[],{cellProps:{"data-testid":"QuizTable__description"},title:i(`resources.${x.QUIZZES}.description`),render:({question:l})=>!l||!l.rendered_url?null:e.createElement(Sa,{url:l.rendered_url,maxHeight:300}),key:"description"},{cellProps:{sx:Y.typeColumn},title:i(`resources.${x.QUIZZES}.type`),render:l=>e.createElement(k,null,i(`resources.choices.quizTypes.${X.QuizType[l.kind]}`)),key:"review"},{title:i("ra.common.actions"),cellProps:{sx:Y.actionColumn},render:(l,C)=>e.createElement(za,{record:l,index:C,size:c,onAction:I,onReOrder:p,onSetQuizReview:()=>g(pe(l,a))}),key:"actions"}],[i,g,a,I,c,p]);return e.createElement(e.Fragment,null,e.createElement(We,{body:{rowKey:u,loading:o||_},data:n,columns:b,tableProps:{"data-testid":"QuizTable__table",sx:Y.table}}))},wa=qe(Ta)(({theme:t})=>({background:t.palette.common.white})),ka=m.exports.forwardRef((t,n)=>{const{loId:a,searchURL:r,wrapperType:o}=t,s=F(),i=Q(),{data:c=[],refetch:u,isFetching:g}=q({entity:"quizzes",action:"syllabusQuizGetManyByLOId"})({lo_id:a},{enabled:!0,onError(f){O.warn("QuizSection fetchQuizzes",f),i(`${s("ra.message.unableToLoadData")} ${f.message}`,"error")}});m.exports.useImperativeHandle(n,()=>({fetchQuiz(){u()}}));const E=o==="box"?st:m.exports.Fragment,y=o==="box"?{sx:f=>({padding:f.spacing(3,4)}),"data-testid":"QuizSection_root"}:{};return e.createElement(E,L({},y),e.createElement(at,{title:s(`resources.${x.QUIZZES}.questionList`),action:e.createElement(xa,{searchURL:r})}),e.createElement(wa,{loId:a,quizzes:c,loading:g,searchURL:r,refetchQuizzes:u}))});var be={},Oa=he.exports;Object.defineProperty(be,"__esModule",{value:!0});var vt=be.default=void 0,Ua=Oa(ge),Pa=K.exports,Qa=(0,Ua.default)((0,Pa.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");vt=be.default=Qa;const ce={reviewAction:{display:"flex",justifyContent:"flex-end"},editorNameInCaution:{maxHeight:"150px",overflow:"hidden"},paper:t=>({padding:t.spacing(4)}),content:t=>({margin:t.spacing(3,0),display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column","& > svg":{marginBottom:t.spacing(4)}})},Ba=a=>{var r=a,{refetchLO:t}=r,n=M(r,["refetchLO"]);const o=n.record,s=F(),i=Q(),c=te(),{parentId:u,bookId:g,chapterId:E}=rt(),{open:y,onClose:f,onOpen:_}=lt(!1),{quizOnReview:d,onCloseReview:p,onSetQuizReview:h}=yt(),I=m.exports.useRef(),{mutate:b,isLoading:l}=R({entity:"quiz",action:"syllabusQuizDelete"})({syllabusMigrationQuery:"default",onSuccess:()=>{i(s("ra.common.deleteSuccess",{smart_count:V},{lowercase:!0})),t(),I.current&&I.current.fetchQuiz(),p(),f()},onError:$=>{if(An.isAppError($))return i(s(`ra.manabie-error.${$.message}`),"error");i(`${s("ra.common.deleteFail")}: ${s("ra.manabie-error.unknown")}`,"error")}}),{mutate:C,isLoading:S}=R({entity:"learningObjective",action:"syllabusLOUpsert"})({syllabusMigrationQuery:"default"}),z=()=>{b({quizId:(d==null?void 0:d.externalId)||"",loId:(d==null?void 0:d.loId)||""})};m.exports.useEffect(()=>()=>{h(null)},[h]);const B=(o==null?void 0:o.type)===P.LEARNING_OBJECTIVE_TYPE_LEARNING,U=pn({[G.PARENT_ID]:String(o.lo_id),[G.CHAPTER_ID]:String(E),[G.BOOK_ID]:String(g),[G.TOPIC_ID]:String(u),[G.TAB]:B?1:0}),T=s(`resources.${x.LOS}.lo`),V=s(`resources.${x.QUIZZES}.question`),ne=m.exports.useCallback(async $=>{const{display_order:_t,name:Ct,prerequisites:xt,school_id:It,topic_id:bt,type:St,lo_id:Lt,video:Dt,study_guide:Ft}=o;let Se=Ft||void 0,Le=Dt||void 0;$.type==="study_guide"&&(Se=$.studyGuideUrl),$.type==="video"&&(Le=$.video.videoId),C({loId:Lt,name:Ct,schoolId:It,topicId:bt,video:Le,studyGuide:Se,displayOrder:Number(_t),prerequisitesList:xt||void 0,type:St},{onSuccess:()=>{t(),i(s("ra.common.updatedSuccess",{smart_count:T},{lowercase:!0}))},onError:At=>{i(s("ra.manabie-error.cannotUpload"),"error"),O.warn("[LOShow] update material",At)}})},[C,o,t,i,s,T]),ae=m.exports.useCallback(()=>{!d||!o||(c.push(`/${ee.SYLLABUS}/${x.QUIZZES}/${d.quizId}/edit${U}`),p())},[d,o,c,U,p]);return e.createElement(e.Fragment,null,o.type===P.LEARNING_OBJECTIVE_TYPE_OFFLINE_LEARNING?e.createElement(fn,{sx:ce.paper},e.createElement(k,{variant:"h5",sx:En},s(`resources.${x.LOS}.choices.LearningObjectiveType.${P.LEARNING_OBJECTIVE_TYPE_OFFLINE_LEARNING}`)),e.createElement(v,{sx:ce.content},e.createElement(Hn,null),e.createElement(k,{variant:"subtitle2"},s("ra.message.noDataInformation")))):e.createElement(e.Fragment,null,B&&e.createElement(Ca,{videoId:o.video,studyGuide:o.study_guide,onChangeAttachment:ne,isLoadingFile:S}),e.createElement(ka,{ref:I,loId:o.lo_id,searchURL:U,wrapperType:B?"box":"no-wrapper"}),d?e.createElement(e.Fragment,null,e.createElement(kn,{open:Boolean(d),title:s(`resources.${x.QUIZZES}.questionDetail`),anchor:"right",quiz:d,"aria-label":"Quiz preview",header:e.createElement(me,{sx:ce.reviewAction,direction:"horizontal"},e.createElement(Pe,{startIcon:e.createElement(On,null),"data-testid":"QuizReview__deleteButton",onClick:_},s(`resources.${x.QUIZZES}.deleteQuestion`)),e.createElement(Pe,{startIcon:e.createElement(vt,null),onClick:ae,"data-testid":"QuizReview__editButton"},s(`resources.${x.QUIZZES}.editQuestion`))),onClose:p}),e.createElement(Et,{"data-testid":"LODetail__confirmDeleteQuizDialog",open:y,onClose:f,onSave:z,disable:l})):null))},nr=()=>{const{breadcrumbInfos:t,loading:n}=Qn(),a=F(),{id:r}=gn(),{data:o,isLoading:s,refetch:i}=q({entity:"learningObjective",action:"LO_GET_ONE"})({lo_id:r},{enabled:Boolean(r)}),c=te(),{isEnabled:u}=ie(se.FLASHCARD_MANAGEMENT),{isEnabled:g}=ie(se.OFFLINE_STUDY_MANAGEMENT),{isEnabled:E}=ie(se.EXAM_LO_MANAGEMENT),{deleteLOs:y,isLoading:f}=Sn(),[_,d]=m.exports.useState(!1),{bookId:p}=rt(),h=m.exports.useCallback(()=>{let U=`/${ee.SYLLABUS}/${x.BOOKS}`;p&&(U+=`/${p}/show`),c.push(U)},[c,p]),I=m.exports.useCallback(async U=>{switch(U){case A.EDIT:{d(!0);return}case A.DELETE:return y({loIdsList:hn(r)},{onSuccess:h});default:return}},[r,y,h]);if(s)return e.createElement(yn,null);if(!o)return null;const b=o.type===P.LEARNING_OBJECTIVE_TYPE_FLASH_CARD,l=o.type===P.LEARNING_OBJECTIVE_TYPE_OFFLINE_LEARNING,C=o.type===P.LEARNING_OBJECTIVE_TYPE_EXAM_LO;if(l&&!g||C&&!E||b&&!u)return e.createElement(vn,{to:"/page-not-found"});const z=P[o.type],B=a(`resources.learning_objectives.choices.LearningObjectiveType.${z}`);return e.createElement(e.Fragment,null,e.createElement(Dn,{loading:n,breadcrumbInfos:t,name:o.name}),e.createElement(at,{title:o.name,action:e.createElement(nt,{record:o,actions:[A.EDIT,A.DELETE],recordName:o.name,loading:f,onAction:I,buttonStyle:"square",suffixDeleteTitle:B})}),b?e.createElement(fa,{record:o}):e.createElement(Ba,{record:o,refetchLO:i}),_&&(C?e.createElement(Ln,{open:_,topicId:o.topic_id,data:o,onClose:()=>d(!1),onSuccess:i}):e.createElement(Ea,{open:_,onClose:()=>d(!1),onSave:()=>{i(),d(!1)},defaultValues:o})))};export{nr as default};
