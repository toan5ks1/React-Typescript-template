import{d6 as I,aS as d,u as O,N as i,eX as w,r as E,d0 as g,ds as A,e1 as N,hP as L,fi as v,eC as T,R as n,d7 as B,gE as $}from"./index.7daee9ef.js";import{u as k,b as F,a as D,Q as P,d as Z}from"./useUpsertQuiz.843c5758.js";import{u as M}from"./useNavigation.f38e637f.js";import{r as G,u as V,v as Y,x as l,F as H}from"./useShowSnackbar.da46e481.js";import{i as K}from"./infer-query.264ca744.js";import{f as X,e as j,c as J,Q as W}from"./Delete.9e106999.js";import"./UploadInput.4c4e4115.js";import"./useMutationV2.0883e427.js";import"./useDialog.8ab3e0e0.js";import"./classCallCheck.4ad2061f.js";import"./useNotifyForm.ee77e08e.js";import"./Draft.ec2d3075.js";import"./useSafeState.fc2ddfd3.js";const ze=()=>{const{id:r}=I(),s=G(),U=V(d.QUIZZES),q=O(),o=Y(),R=i(X),t=i(j),b=i(e=>e.quiz.quizOnReview),p=i(e=>e.quiz.pdfUrl),{onCloseReview:x,onClearState:y}=k(),z=i(J),{upsertQuiz:m,isLoading:f}=F(),{isFetching:_,id:u,searchURL:Q,onNotify:c}=D({action:w.EDIT}),S=M(),a=E.exports.useCallback(()=>{S.push(`/${g.SYLLABUS}/${d.LOS}/${u}/show${Q}`)},[u,S,Q]),{isLoading:h}=K({entity:"quizzes",action:"syllabusQuizGetOne"})({quiz_id:r},{enabled:Boolean(r),onSuccess:e=>{if(A(e)){l.warn("Cannot found QUIZ_GET_ONE data by quiz_id",r),o(s("ra.notification.item_doesnt_exist"),"error");return}q(W.setCurrentQuiz(H(e,u)))},onError:e=>{l.warn("Quiz Edit page",e),o(s("ra.notification.item_doesnt_exist"),"error"),a()}});N(()=>{y()});const C=E.exports.useCallback(()=>{m({quiz:t},{onSuccess:()=>{a(),c(L.SUCCESS,{},"")},onError:e=>{if(l.warn("[QUIZ edit]",e),v.isAppError(e))return o(s(e.message),T.ERROR);c(L.FAILURE,{},e.message)}})},[m,t,a,c,o,s]);return h||_?n.createElement(B,null):!t||!t.externalId||!z||!(z.quiz_sets||[]).find(e=>e.quiz_external_ids.includes(t.externalId))?n.createElement($,{redirect:`/${g.SYLLABUS}/${d.BOOKS}`}):n.createElement(P,{loading:f,disabled:!R,expandActionSpace:Boolean(p),quizOnReview:b,onCancel:a,onSubmit:C,onCloseReview:x,title:U("editQuestion")},n.createElement(Z,{disabled:f,pdfUrl:p,externalIdProps:{editExternalIdDisabled:!0}}))};export{ze as default};
