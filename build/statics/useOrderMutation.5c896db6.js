import{cV as O,gK as _,g8 as f,g6 as w,g7 as L,aS as a,b as E,d0 as T}from"./index.7daee9ef.js";import{p as A,i as S}from"./infer-mutation.50915866.js";const U=e=>{const{associatedProducts:o,packageCourses:r,product:t,discount:i}=e,u=(o==null?void 0:o.map(({courseId:s,product:c})=>{var d;return{packageId:(d=e.product)==null?void 0:d.product_id,courseId:s,productId:c.product_id,productType:A[c.product_type]}}))||[],n=(r==null?void 0:r.map(({course:s,packageCourse:c,slot:d})=>({courseId:s.course_id,courseName:s.name,weight:c.course_weight,slot:d})))||[];return{productId:t==null?void 0:t.product_id,discountId:i==null?void 0:i.discount_id,productAssociationsList:u,courseItemsList:n}},B=(e,o)=>{const{product:r,discount:t}=e;o.push({productId:r.product_id,discountId:t==null?void 0:t.discount_id,productAssociationsList:[],courseItemsList:[]})},b=(e,o,r)=>{const t=[];let i=[],u=[];for(const n of e.productFieldArrayItem){const{product:s,productPrices:c,associatedProducts:d}=n;if(!s||!O(c))continue;const p=_(n),{getBillingItems:m,getUpcomingBillingItems:g}=r(p),I=m(n),l=g(n);i.push(...I),u.push(...l);const y=U(n);t.push(y);for(const h of d!=null?d:[])B(h,t)}return{studentId:e.student.student_id,locationId:e.location.locationId,orderComment:e.comment,orderType:o,orderItemsList:t,billingItemsList:i,upcomingBillingItemsList:u}},R=({onUpsertError:e})=>{const o=f(),r=w(),t=L(a.ORDERS),i=E(),{mutate:u,isLoading:n}=S({entity:"orderPayment",action:"paymentUpsertOrder"})({onSuccess:s=>{o(t("message.success.createOrder")),i.push(`/${T.PAYMENT}/${a.ORDERS}/${s.orderId}/show`)},onError:s=>{var c;o(r(s.message),"error"),(c=window.warner)==null||c.warn(`Error OrderManagementUpsert: ${r(s.message)}`),e(s.message)}});return{onUpsert:u,isOnUpsertLoading:n}};export{b as t,R as u};
