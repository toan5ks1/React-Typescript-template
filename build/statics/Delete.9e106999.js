var wt=Object.defineProperty,St=Object.defineProperties;var Tt=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var ke=(e,t,r)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))Oe.call(t,r)&&ke(e,r,t[r]);if(G)for(var r of G(t))Le.call(t,r)&&ke(e,r,t[r]);return e},Q=(e,t)=>St(e,Tt(t));var O=(e,t)=>{var r={};for(var a in e)Oe.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&G)for(var a of G(e))t.indexOf(a)<0&&Le.call(e,a)&&(r[a]=e[a]);return r};import{dq as te,dr as ne,bp as ae,R as n,aj as p,c$ as At,fd as K,io as bt,ip as ge,iq as T,r as s,c2 as fe,ij as Y,ak as Ee,bj as Rt,c6 as Dt,c9 as Mt,ir as L,eC as kt,is as et,c4 as ze,dp as Ot,cL as tt,aS as b,a9 as nt,cJ as Lt,cb as zt,cU as N,it as Qe,cj as Qt,i3 as Nt,en as Ne,em as Bt,fE as xe,a8 as at,du as $t,iu as Ut,iv as Ft,iw as re,a1 as Pt,ix as Be,iy as $e,iz as Ht,iA as Zt,iB as qt,iC as jt,iD as Jt,d7 as Gt,aK as Kt,iE as Wt,iF as Vt,hp as I,cE as Yt,cK as W,im as V,iG as Xt,ik as Ue,aJ as B,ck as de,cZ as en,iH as tn,iI as nn,iJ as an,iK as rn,iL as on,g5 as D}from"./index.7daee9ef.js";import{y as sn,v as rt,r as H,x as ee,u as ye,w as ln,G as cn,H as Fe,J as dn,L as un,M as pn,N as mn}from"./useShowSnackbar.da46e481.js";import{d as En,a as xn,b as gn,c as fn}from"./Draft.ec2d3075.js";import{u as yn}from"./useSafeState.fc2ddfd3.js";import{U as hn}from"./UploadInput.4c4e4115.js";import{i as In}from"./infer-query.264ca744.js";var he={},Cn=ne.exports;Object.defineProperty(he,"__esModule",{value:!0});var ot=he.default=void 0,_n=Cn(te),vn=ae.exports,wn=(0,_n.default)((0,vn.jsx)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"}),"VolumeUp");ot=he.default=wn;const Pe={root:{display:"flex",flexDirection:"column"},title:e=>({marginBottom:e.spacing(1),color:e.palette.text.light,fontWeight:500}),value:{}},X=e=>{const i=e,{title:t,value:r,className:a}=i,o=O(i,["title","value","className"]);return n.createElement(p,h({},o),n.createElement(p,{sx:Pe.title},t),n.createElement(p,{sx:Pe.value},r))};function Sn(){const{isEnabled:e}=sn(At.SYLLABUS_QUIZ_CTRLV_UPLOAD_IMAGE);return{canPasteFile:e}}var P=(e=>(e.CSV="text/csv",e.VIDEO="video/*",e.IMAGE="image/*",e.AUDIO="audio/*",e.PDF="application/pdf",e.MSWORD="application/msword",e))(P||{});const Tn=async e=>new Promise((t,r)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=o=>r(o),a.readAsDataURL(e)});var We,Ve,Ye,Xe;const An={[P.PDF]:(We=K)==null?void 0:We.MEDIA_TYPE_PDF,[P.VIDEO]:(Ve=K)==null?void 0:Ve.MEDIA_TYPE_VIDEO,[P.AUDIO]:(Ye=K)==null?void 0:Ye.MEDIA_TYPE_AUDIO,[P.IMAGE]:(Xe=K)==null?void 0:Xe.MEDIA_TYPE_IMAGE};function bn(e){return({type:t})=>bt({type:t},e)||An[e]===t}const Rn=bn(P.IMAGE),Dn=r=>{var a=r,{className:e}=a,t=O(a,["className"]);return n.createElement(p,h({component:"audio",sx:{outline:"none","&:focus":{outline:"none"}},className:e,controls:!0},t))},Mn=({block:e,contentState:t})=>{const r=t.getEntity(e.getEntityAt(0)).getData().data;return n.createElement(Dn,{controls:!0,src:r})},kn=ge(T.BLOCK_AUDIO,Mn),On=({blockProps:e,block:t,contentState:r})=>{const[a,o]=s.exports.useState(!1),i=fe(),c=s.exports.useCallback(()=>{a||e.readOnly||(o(!0),e.onStartEdit(t.getKey()))},[a,e,t]),l=s.exports.useCallback(()=>{o(!1),e.onBlockRemove(t.getKey()),e.onEndEdit(t.getKey())},[e,t]),d=s.exports.useCallback(()=>{o(!1),e.onEndEdit(t.getKey())},[e,t]),u=s.exports.useMemo(()=>r.getEntity(t.getEntityAt(0)).getData().data,[r,t]);return n.createElement(p,{sx:{textAlign:"center"}},n.createElement(p,{component:"img",sx:{width:"100%"},src:u,alt:"rich text inlined",onClick:c}),a&&n.createElement(Y,{direction:"horizontal",spacing:8},n.createElement(Ee,{color:"default",onClick:d},i("ra.common.action.cancel")),n.createElement(Ee,{color:"error",onClick:l},i("ra.common.action.remove"))))},Ln=ge(T.BLOCK_IMAGE,On);function zn(e,t,r){e.findEntityRanges(a=>{const o=a.getEntity();return o!==null&&r.getEntity(o).getType()==="LINK"},t)}const Qn=e=>{const t=Rt(),{url:r}=e.contentState.getEntity(e.entityKey).getData();return n.createElement("a",{"data-testid":"BlockLink__root",href:r,target:"_blank",rel:"noreferrer",onClick:a=>{a.stopPropagation()},style:{color:t.palette.primary.main,textDecoration:"underline"}},e.children)},Nn={strategy:zn,component:Qn},st=e=>{const o=e,{children:t,onClose:r}=o,a=O(o,["children","onClose"]);return n.createElement(Dt,h({},a),n.createElement(Mt,{mouseEvent:"onClick",touchEvent:"onTouchEnd",onClickAway:r},t))},it=()=>{const e=rt(),t=H(),[r,a]=s.exports.useState(null),[o,i]=s.exports.useState(L.LOADED),c=()=>{var d;if((d=window.MathJax)!=null&&d.config){i(L.LOADED),a(window.MathJax);return}if(!document.getElementById("mathJaxScript")){const u=document.createElement("script");u.type="text/javascript",u.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-svg.js",u.id="mathJaxScript",u.async=!0,window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0},startup:{typeset:!1,ready:()=>{window.MathJax.startup.defaultReady(),ee.info("MathJax is initialized"),a(window.MathJax),i(L.LOADED)}},options:{renderActions:{assistiveMml:[]},menuOptions:{settings:{assistiveMml:!1}}},loader:{load:["[tex]/mhchem"]},packages:{"[+]":["mhchem"]}},document.head.insertAdjacentElement("beforeend",u)}};return s.exports.useEffect(()=>{var l;if(typeof window!="undefined")if((l=window.MathJax)!=null&&l.config)i(L.INJECTED),c();else{i(L.NOT_INJECTED),c();let d=5;const u=setInterval(()=>{var m;(m=window.MathJax)!=null&&m.config?(i(L.LOADED),clearInterval(u)):d-=1,d||(ee.error("[useInstallMathjax]",t("ra.manabie-error.mathJaxLoadTooLong")),e(t("ra.manabie-error.mathJaxLoadTooLong"),kt.ERROR),clearInterval(u),i(L.LOADED))},1e3)}},[o,e,t]),{mathJaxHub:r,loadStatus:o}};function lt(e){const[t,r]=s.exports.useState(e),a=s.exports.useRef(null),[o,i]=s.exports.useState(!1),{mathJaxHub:c}=it(),l=s.exports.useCallback(d=>{r(d.target.value)},[]);return s.exports.useEffect(()=>{(async()=>{if(c){const u=await c.tex2svgPromise(t);requestAnimationFrame(()=>{a.current&&(a.current.innerHTML="",a.current.appendChild(u));const m=u.querySelectorAll('[data-mml-node="merror"]');i(m.length>0)})}})()},[t,c,a]),{hasError:o,nodeMathJax:a,value:t,onTexChange:l}}const $={value:{display:"flex",justifyContent:"center"},editPopper:{position:"relative"},editWrapper:{display:"flex",flexDirection:"column",background:"white",padding:12,zIndex:2},textArea:e=>({padding:e.spacing(1)}),btn:e=>({margin:e.spacing(1)}),btnWrapper:{display:"flex",justifyContent:"flex-end"}},Bn=({blockProps:e,block:t,contentState:r})=>{const a=s.exports.useCallback(()=>r.getEntity(t.getEntityAt(0)).getData().data,[r,t]),o=s.exports.useRef(null),[i,c]=s.exports.useState(!1),{nodeMathJax:l,hasError:d,value:u,onTexChange:m}=lt(a),E=fe(),_=s.exports.useCallback(()=>{i||e.readOnly||(requestAnimationFrame(()=>{var R;(R=o.current)==null||R.focus()}),c(!0),e.onStartEdit(t.getKey()))},[i,e,t,o]),f=s.exports.useCallback(()=>{c(!1),e.onBlockRemove(t.getKey()),e.onEndEdit(t.getKey())},[e,t]),y=s.exports.useCallback(()=>{c(!1),e.onBlockUpdate(t.getKey(),{data:u}),e.onEndEdit(t.getKey())},[e,t,u]),v=s.exports.useCallback(()=>{d||(c(!1),e.onEndEdit(t.getKey()))},[d,e,t]);return n.createElement("div",null,n.createElement(p,{sx:$.value,ref:l,onClick:_}),n.createElement(st,{open:i,anchorEl:l.current,onClose:v},n.createElement(et,{sx:$.editWrapper},n.createElement(p,{component:"textarea",sx:$.textArea,ref:o,value:u,onChange:m}),n.createElement(p,{sx:$.btnWrapper},n.createElement(ze,{sx:$.btn,color:"default",variant:"outlined",onClick:f},E("ra.common.action.remove")),n.createElement(ze,{sx:$.btn,disabled:d,variant:"contained",color:"primary",onClick:y},E(`ra.common.${d?"invalid":"done"}`))))))},$n=ge(T.BLOCK_MATHJAX,Bn);var S=(e=>(e.INLINE="INLINE",e.BLOCK="BLOCK",e.ATOMIC="ATOMIC",e))(S||{});const He={root:{flexShrink:0,color:"rgba(0, 0, 0, 0.54)",cursor:"pointer",marginRight:"16px",padding:"2px 0",display:"inline-block","&:hover":{backgroundColor:"unset"}},active:{color:"#5890ff"}},oe=s.exports.forwardRef((e,t)=>{const{style:r,tooltip:a="",active:o,children:i,onClick:c}=e;return n.createElement(Ot,{title:a},n.createElement(tt,{"aria-label":a,sx:[He.root,o&&He.active],size:"small",style:r,onClick:c,onMouseDown:l=>{l.preventDefault()}},i))});function Ie({label:e,icon:t,controlValue:r}){return({editorState:a,onClick:o})=>{const i=H(),c=a.getCurrentInlineStyle();return n.createElement(oe,{tooltip:i(e),active:c.has(r),onClick:l=>o(l,r)},s.exports.createElement(t))}}function Un({label:e,controlValue:t,icon:r}){return({blockType:a,onClick:o})=>{const i=H();return n.createElement(oe,{tooltip:i(e),active:a===t,onClick:c=>o(c,t)},s.exports.createElement(r))}}const Fn=Ie({controlValue:"BOLD",label:`resources.${b.QUIZZES}.bold`,icon:En}),Pn=Ie({controlValue:"ITALIC",label:`resources.${b.QUIZZES}.italic`,icon:xn}),Hn=Ie({controlValue:"UNDERLINE",label:`resources.${b.QUIZZES}.underline`,icon:gn});var Ce={},Zn=ne.exports;Object.defineProperty(Ce,"__esModule",{value:!0});var ct=Ce.default=void 0,qn=Zn(te),jn=ae.exports,Jn=(0,qn.default)((0,jn.jsx)("path",{d:"M9 4v3h5v12h3V7h5V4H9zm-6 8h3v7h3v-7h3V9H3v3z"}),"FormatSize");ct=Ce.default=Jn;function Gn(){const[e,t]=yn(null),r=s.exports.useCallback(o=>{t(o.currentTarget)},[t]),a=s.exports.useCallback(()=>{t(null)},[t]);return{anchorEl:e,open:Boolean(e),onOpen:r,onClose:a}}var dt=(e=>(e.H6="H6",e.H5="H5",e.H4="H4",e.H3="H3",e.H2="H2",e))(dt||{});const ut={H6:"header-six",H5:"header-five",H4:"header-four",H3:"header-three",H2:"header-two"},Kn=nt(dt).getValues(),Wn=nt(ut).getValues(),Vn="abc",Yn=e=>{const{blockType:t,onClick:r}=e,{open:a,onOpen:o,anchorEl:i,onClose:c}=Gn(),l=ye(b.QUIZZES),d=s.exports.useCallback((u,m)=>{r(u,m),c()},[r,c]);return n.createElement(n.Fragment,null,n.createElement(oe,{tooltip:l("heading"),onClick:o,active:Wn.includes(t)},n.createElement(ct,null)),n.createElement(Lt,{open:a,anchorEl:i,keepMounted:!1,onClose:c,onMouseDown:u=>u.preventDefault(),disableAutoFocus:!0,disableEnforceFocus:!0,autoFocus:!1},Kn.map(u=>{const m=ut[u];return n.createElement(zt,{key:u,value:u,selected:t===m,onClick:E=>d(E,m)},s.exports.createElement(u.toLowerCase(),{style:{margin:0}},Vn))})))},Xn=[Fn,Pn,Hn],pt=e=>{const{editorState:t,onChange:r,manualControl:a}=e,o=s.exports.useCallback((i,c)=>{r(N.RichUtils.toggleInlineStyle(t,c))},[t,r]);return n.createElement(n.Fragment,null,(a||Xn).map((i,c)=>n.createElement(i,{key:c,editorState:t,onClick:o,onChange:r})))},ea=Un({controlValue:"unordered-list-item",label:`resources.${b.QUIZZES}.ul`,icon:fn}),ta=[Yn,ea],mt=e=>{const{editorState:t,onChange:r,manualControl:a}=e,o=t.getSelection(),i=t.getCurrentContent().getBlockForKey(o.getStartKey()).getType(),c=s.exports.useCallback((l,d)=>{r(N.RichUtils.toggleBlockType(t,d))},[t,r]);return n.createElement(n.Fragment,null,(a||ta).map((l,d)=>n.createElement(l,{key:d,onClick:c,blockType:i})))};var _e={},na=ne.exports;Object.defineProperty(_e,"__esModule",{value:!0});var Et=_e.default=void 0,aa=na(te),ra=ae.exports,oa=(0,aa.default)((0,ra.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"Image");Et=_e.default=oa;const sa=[{label:"audio",icon:ot,accept:"audio/*",craftFn:Qe(T.BLOCK_AUDIO)},{label:"image",icon:Et,accept:"image/*",craftFn:Qe(T.BLOCK_IMAGE)}],xt=({onChange:e,editorState:t,manualControl:r})=>{const[a,o]=s.exports.useState(null),i=H(),{size:c,unit:l}=Bt(Ne),d=s.exports.useCallback(E=>{o(E)},[]),u=s.exports.useCallback(()=>{o(null)},[]),m=s.exports.useCallback((E,_)=>{const f=Qt(_);if(f&&a){const y=a.craftFn(t,f);e(y),u()}},[t,a,e,u]);return n.createElement(n.Fragment,null,(r||sa).map(E=>n.createElement(oe,{key:E.accept,active:!1,tooltip:i(`resources.${b.QUIZZES}.${E.label}`),onClick:()=>d(E)},s.exports.createElement(E.icon))),a?n.createElement(Nt,{open:Boolean(a),onClose:u,title:i(`resources.${b.QUIZZES}.uploadYourFile`),maxWidth:"md",minWidth:"500px"},n.createElement(hn,{multiple:!1,maxSize:Ne,description:i("ra.message.maxFileSizeIs",{fileSize:c,fileUnit:l}),accept:a.accept,onChange:m,autoUpload:!0})):null)},Xa=[S.INLINE,S.BLOCK,S.ATOMIC],er=[S.INLINE],Ze={root:e=>({display:"flex",justifyContent:"space-between",flexWrap:"wrap",padding:e.spacing(1,2),background:"#FAFAFA",alignItems:"center",fontSize:14,marginBottom:"5px",userSelect:"none",borderTopLeftRadius:8,borderTopRightRadius:8,"& > *":{flexShrink:0}}),controls:{display:"flex",justifyContent:"flex-start",flex:"1 1",height:"28px"}},ia={[S.INLINE]:pt,[S.BLOCK]:mt,[S.ATOMIC]:xt},la=({editorState:e,children:t,controls:r=[],onChange:a})=>{if(xe.exports.isEmpty(r))return null;const o=c=>xe.exports.map(c,l=>{const d=ia[l];return d?n.createElement(d,{key:l,editorState:e,onChange:a}):null}),i=c=>Object.keys(c).map(l=>{if(l===S.ATOMIC)return n.createElement(xt,{key:l,manualControl:c[l],editorState:e,onChange:a});if(l===S.INLINE)return n.createElement(pt,{key:l,manualControl:c[l],editorState:e,onChange:a});if(l===S.BLOCK)return n.createElement(mt,{key:l,manualControl:c[l],editorState:e,onChange:a})});return n.createElement(p,{sx:Ze.root},n.createElement(p,{sx:Ze.controls},Array.isArray(r)?o(r):i(r)),t?n.createElement("div",null,t):null)},ca={warning:{color:"#FF9800"},success:{color:"#4CAF50"},error:{color:"#F44336"},text:{color:"#212121"}},qe="Radio",je={radioRoot:`${qe}-radioRoot`,radioChecked:`${qe}-radioChecked`};at($t)({[`&.${je.radioRoot}`]:{width:18,height:18,overflow:"hidden",color:"transparent"},[`& .${je.radioChecked}`]:{color:"transparent",border:"3px solid #E0E0E0"}});`&.${Ft.checked}`+"";const da=re(T.INLINE_BLANK),ua=" ".repeat(12),pa=({offsetKey:e})=>n.createElement(p,{component:"span",sx:{textDecoration:"underline"},"data-offset-key":e},ua),ma={strategy:da,component:pa,props:{readOnly:!0}},Ea=re(T.INLINE_IMAGE),xa=function({offsetKey:e,contentState:t,entityKey:r,children:a}){const{data:o}=t.getEntity(r).getData();return n.createElement("span",{"data-offset-key":e},n.createElement(p,{component:"img",sx:{maxWidth:"100%"},src:o,alt:"wyswyg inlined upload"}),a)},ga={strategy:Ea,component:xa},fa=re(T.INLINE_MATHJAX),ue={textArea:{padding:"10px",width:"320px",minHeight:"100px"},doneBtn:{marginTop:"8px",float:"right"},card:{padding:"10px",display:"flex",flexDirection:"column"}},ya=function(e){const{offsetKey:t,contentState:r,entityKey:a,children:o,readOnly:i,onStartEdit:c,onEndEdit:l,onInlineUpdate:d}=e,u=s.exports.useCallback(()=>r.getEntity(a).getData().data,[r,a]),m=s.exports.useRef(null),[E,_]=s.exports.useState(!1),{nodeMathJax:f,hasError:y,value:v,onTexChange:R}=lt(u),M=fe(),w=s.exports.useCallback(()=>{E||i||(requestAnimationFrame(()=>{var j;(j=m.current)==null||j.focus()}),_(!0),c(a))},[a,E,m,i,c]),k=s.exports.useCallback(()=>{_(!1),d(a,{data:v}),l(a)},[v,a,l,d]),z=s.exports.useCallback(()=>{y||(_(!1),l(a))},[y,l,a]);return n.createElement("span",{"data-offset-key":t},n.createElement("span",{ref:f,onClick:w},v),n.createElement(st,{sx:{zIndex:1500},modifiers:[{name:"offset",options:{offset:[0,10]}}],open:E,anchorEl:f.current,placement:"bottom-start",onClose:z},n.createElement(et,{sx:ue.card,square:!0},n.createElement(p,{component:"textarea",sx:ue.textArea,ref:m,value:v,onChange:R}),n.createElement("div",null,n.createElement(Ee,{sx:ue.doneBtn,disabled:y,variant:"contained",color:"primary",onClick:k},M("ra.common.done"))))),o)},ha=e=>({props:e,component:ya,strategy:fa}),Ia=e=>{const{width:t=6,height:r=6}=e;return n.createElement("svg",{width:t,height:r,viewBox:"0 0 6 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M5.66732 2.99998C5.66732 4.47274 4.47341 5.66665 3.00065 5.66665C1.52789 5.66665 0.333984 4.47274 0.333984 2.99998C0.333984 1.52722 1.52789 0.333313 3.00065 0.333313C4.47341 0.333313 5.66732 1.52722 5.66732 2.99998ZM1.13398 2.99998C1.13398 4.03091 1.96972 4.86665 3.00065 4.86665C4.03158 4.86665 4.86732 4.03091 4.86732 2.99998C4.86732 1.96905 4.03158 1.13331 3.00065 1.13331C1.96972 1.13331 1.13398 1.96905 1.13398 2.99998Z",fill:"#E0E0E0"}),n.createElement("path",{d:"M5.26732 2.99998C5.48823 2.99998 5.67039 2.81991 5.63737 2.60148C5.60517 2.38839 5.54718 2.1795 5.46433 1.97949C5.33032 1.65596 5.13389 1.36198 4.88627 1.11436C4.63865 0.866739 4.34467 0.670313 4.02114 0.536301C3.82113 0.453454 3.61224 0.395462 3.39916 0.363257C3.18072 0.330244 3.00065 0.512399 3.00065 0.733313C3.00065 0.954227 3.18174 1.12903 3.3976 1.17601C3.50589 1.19957 3.61212 1.23279 3.71499 1.2754C3.94147 1.36921 4.14725 1.50671 4.32058 1.68005C4.49392 1.85338 4.63142 2.05916 4.72523 2.28564C4.76784 2.38851 4.80106 2.49474 4.82462 2.60303C4.8716 2.81889 5.0464 2.99998 5.26732 2.99998Z",fill:"#64B6F7"}))},Ca=re(T.LOADING_IMAGE),pe={wrapper:{position:"relative",display:"inline-block",fontSize:"0"},spinner:e=>({width:"8px",height:"8px",position:"absolute",bottom:"1px",right:"1px",borderRadius:"25%",padding:e.spacing(.125),background:e.palette.grey[100],"& svg":{borderRadius:"50%",animation:`$spinner 900ms ${e.transitions.easing.sharp} infinite`}}),spinner2:e=>({bottom:"1px",right:"1px",width:"4px",height:"4px",padding:e.spacing(.125)}),spinner6:e=>({bottom:"1px",right:"1px",width:"8px",height:"8px",padding:e.spacing(.125)}),spinner8:e=>({bottom:"2px",right:"2px",width:"12px",height:"12px",padding:e.spacing(.25)}),spinner12:e=>({bottom:"4px",right:"4px",width:"16px",height:"16px",padding:e.spacing(.25)}),spinner20:e=>({bottom:"4px",right:"4px",width:"24px",height:"24px",padding:e.spacing(.25)}),"@keyframes spinner":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}},_a=(e,t)=>e<=16&&t<=16?2:e<=24&&t<=24?6:e<=48&&t<=48?8:e<200&&t<200?12:20,va=function({offsetKey:e,contentState:t,entityKey:r,children:a}){const{data:o}=t.getEntity(r).getData(),[i,c]=s.exports.useState(6),l=d=>{const{width:u,height:m}=d.target;c(_a(u,m))};return n.createElement("span",{"data-offset-key":e,"data-testid":"Editor__loading-image"},n.createElement(p,{sx:pe.wrapper},n.createElement("img",{src:o,alt:"wyswyg loading image",onLoad:l}),n.createElement(p,{sx:[pe.spinner,pe[i]]},n.createElement(Ia,{width:i,height:i}))),a)},wa={strategy:Ca,component:va},Sa=()=>{const e=rt(),t=H(),{isLoading:r,mutate:a,mutateAsync:o}=ln({entity:"media",action:"MEDIA_FILTER_AND_UPLOAD_FILES"})({onError:l=>{ee.warn("[useUploadFiles]",l),e(`${t("ra.manabie-error.cannotUpload")}: ${l.message}`,"error")}}),i=s.exports.useCallback((l,d)=>a(l,d),[a]),c=s.exports.useCallback((l,d)=>o(l,d),[o]);return{onUploadFiles:i,onUploadFilesAsync:c,isUploading:r}},U="Editor",C={root:`${U}-root`,bordered:`${U}-bordered`,error:`${U}-error`,displayOnly:`${U}-displayOnly`,minHeight:`${U}-minHeight`,hiddenPlaceholder:`${U}-hiddenPlaceholder`},Ta=at("div")(({theme:e})=>({[`&.${C.root}`]:{borderRadius:e.spacing(.5),background:e.palette.common.white,width:"100%",height:"100%","& .DraftEditor-root":{height:"100% !important",padding:8,"&:focus":{outline:"none"}},"& .DraftEditor-editorContainer":{height:"auto"},"& .public-DraftEditor-content":{whiteSpace:"normal",overflow:"auto","&:focus":{outline:"none"}},"& .public-DraftEditorPlaceholder-root":{width:"unset !important",userSelect:"none",position:"absolute",pointerEvents:"none"}},[`&.${C.bordered}`]:{border:"1px solid rgba(0, 0, 0, 0.23)"},[`&.${C.error}`]:{border:`1px solid ${e.palette.error.main}`},[`&.${C.displayOnly}`]:{border:"none",minHeight:"auto","& > .DraftEditor-root":{padding:0},"& > .Draft-public":{padding:"8px 0 0 0"}},[`&.${C.minHeight}`]:{"& .public-DraftEditor-content":{minHeight:e.spacing(11)}},[`&.${C.hiddenPlaceholder}`]:{"& .public-DraftEditorPlaceholder-root":{display:"none"}}})),Aa=()=>{},Je=[Ln,$n,kn],ba=e=>{const t=e.getCurrentContent();return!t.hasText()&&t.getBlockMap().first().getType()!=="unstyled"},Ra=e=>{const Ae=e,{editorState:t,onChange:r=Aa,displayOnly:a=!1,placeholder:o,readOnly:i=!1,noStyle:c=!1,actions:l,toolbar:d,error:u,editorClassName:m,canPasteFile:E}=Ae,_=O(Ae,["editorState","onChange","displayOnly","placeholder","readOnly","noStyle","actions","toolbar","error","editorClassName","canPasteFile"]),[f,y]=s.exports.useState(!1),[v,R]=s.exports.useState({}),M=s.exports.useRef(null),{onUploadFilesAsync:w}=Sa(),k=x=>{r(qt(t,x))},z=(x,g)=>{r(jt(t,x,g))},j=(x,g)=>{r(Jt(t,x,g))},we=x=>{R(g=>Q(h({},g),{[x]:!0}))},Se=x=>{R(g=>{let A={};for(const Z in g)Z!==x&&(A[Z]=!0);return A})},se=Object.keys(v).length>0||i||a,yt=x=>{for(let g=0;g<Je.length;g++){const A=Je[g](t.getCurrentContent(),{readOnly:se,onStartEdit:we,onEndEdit:Se,onBlockRemove:k,onBlockUpdate:z},x);if(A)return A}return null},ht=(x,g)=>{const A=N.RichUtils.handleKeyCommand(g,x);return A?(r(A),"handled"):"not-handled"},It=x=>x&&x.length>0&&Rn({type:x[0].type})?((async()=>{var Z,be;y(!0);const g=await Tn(x[0]),A=Be(T.LOADING_IMAGE)(t,g);r(A);try{let ie=[];ie=(await w(x)).attachments.map(J=>J.resource);const De=cn(ie),le=(Z=M.current)==null?void 0:Z.props.editorState,Me=$e(le);if(De){const J=Be(T.INLINE_IMAGE)(Me,De);if(le.getSelection().getHasFocus()){const ce=le.getSelection();r(N.EditorState.forceSelection(J,ce))}else{const ce=Ht(J),vt=Zt(JSON.stringify(ce));r(vt)}}else r(Me)}catch{ee.warn("[Editor] handlePastedFiles",u);const Re=$e((be=M.current)==null?void 0:be.props.editorState);r(Re)}finally{y(!1)}})(),"handled"):"not-handled",Te=N.EditorState.set(t,{decorator:new N.CompositeDecorator([ga,ma,Nn,wa,ha({readOnly:se,onStartEdit:we,onEndEdit:Se,onInlineUpdate:j})])}),Ct=!a&&!xe.exports.isEmpty(d),_t=ba(t);return n.createElement(Ta,{className:Pt({[C.root]:!0,[C.bordered]:!c,[C.displayOnly]:a,[C.minHeight]:!a,[C.hiddenPlaceholder]:_t,[C.error]:u,[e.className||""]:!0}),style:e.style},Ct&&n.createElement(la,{editorState:Te,controls:d,onChange:r},l),n.createElement(p,{className:m==null?void 0:m.wrapperDraft,"data-testid":"Editor__content"},n.createElement(N.Editor,Q(h({},_),{ref:M,editorState:Te,readOnly:se,placeholder:o,blockRendererFn:yt,onChange:r,handleKeyCommand:ht,customStyleMap:ca,webDriverTestID:"Editor__draftEditor",handlePastedFiles:E&&!f?It:void 0}))))};var Da=s.exports.memo(Ra);const q=e=>{const{loadStatus:t}=it(),{canPasteFile:r}=Sn();return t===L.LOADED?n.createElement(Da,Q(h({},e),{canPasteFile:r})):n.createElement(Gt,{size:24})},Ma=e=>{const c=e,{value:t,label:r}=c,a=O(c,["value","label"]),{data:o}=In({entity:"learningObjective",action:"LO_GET_MANY_BY_IDS"})({lo_id:t},{enabled:!0}),i=s.exports.useMemo(()=>o?o.map(l=>l.name).join(", "):"",[o]);return n.createElement(X,Q(h({},a),{title:r,value:i}))},gt=s.exports.createContext({readOnly:!1}),{Provider:ka}=gt,Oa=({children:e,readOnly:t})=>n.createElement(ka,{value:{readOnly:t}},e),tr=()=>s.exports.useContext(gt),me={root:e=>{var t;return{border:`1px solid ${(t=e.palette.border)==null?void 0:t.main}`,position:"relative",display:"flex",alignItems:"center",padding:e.spacing(1.5),borderRadius:e.spacing(1)}},correctWrapper:e=>{var t;return{border:`1px solid ${(t=e.palette.success)==null?void 0:t.main}`}},correct:e=>{var t;return{position:"absolute",padding:e.spacing(.5,2/3),zIndex:20,right:e.spacing(2),color:(t=e.palette.success)==null?void 0:t.main,background:e.palette.common.white,top:e.spacing(-1.5),textTransform:"uppercase",fontSize:"0.625rem"}}},ft=e=>{const{className:t,children:r,component:a=p,correct:o}=e,i=ye(b.QUIZZES);return n.createElement(a,{sx:[me.root,o&&me.correctWrapper],className:t},r,o?n.createElement(Kt,{sx:me.correct},i("correct")):null)},Ge={wrapper:e=>({display:"flex",alignItems:"center","& > :fist-of-type":{marginRight:e.spacing(8)}}),listType:e=>({borderRadius:"50%",maxWidth:e.spacing(10),height:34,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",marginRight:e.spacing(1),overflow:"hidden","& fieldset":{border:"none"}})},La=e=>{const{answer:t}=e;return n.createElement(ft,Q(h({},e),{correct:!1}),n.createElement(p,{sx:Ge.wrapper},t.label?n.createElement(Wt,{sx:Ge.listType,value:t.label,disabled:!0,InputProps:{readOnly:!0}}):null,n.createElement(q,{editorState:t.content,displayOnly:!0})))},za=e=>{const{answer:t}=e;return n.createElement(ft,h({},t),n.createElement(q,{displayOnly:!0,editorState:t.content}))},Qa={textEntity:{marginTop:0,marginBottom:0,maxWidth:"100%",overflowWrap:"anywhere"},actionWrapper:e=>({display:"flex",justifyContent:"space-between",flexWrap:"wrap",alignItems:"center",[e.breakpoints.down("md")]:{flexWrap:"wrap"}}),actionPanel:{display:"flex",alignItems:"center","& > *:not(:first-of-type)":e=>({marginLeft:e.spacing(1.5)}),[`& .${Vt.item}:nth-of-type(1) button:not(:disabled)`]:e=>({color:e.palette.text.light})}},Na=({kind:e})=>{const t=s.exports.useMemo(()=>{let o={secondary:"questionDescription",subRequired:!0,required:!1};return Fe(e)&&(o.primary="term"),o},[e]),r=s.exports.useMemo(()=>{let o={primary:"answers",subRequired:!0,required:!1};return Fe(e)&&(o.primary="definition"),(e===I.QuizType.QUIZ_TYPE_MAQ||e===I.QuizType.QUIZ_TYPE_MCQ)&&(o.required=!0),o},[e]),a=s.exports.useMemo(()=>{let o={primary:"explanation",secondary:"explanationDescription",subRequired:!1,required:!1};return e===I.QuizType.QUIZ_TYPE_MIQ&&(o.subRequired=!0),o},[e]);return{answerInstruction:r,questionInstruction:t,explanationInstruction:a}},Ke={wrapper:e=>({padding:e.spacing(3),width:450}),header:{},actionWrapper:{marginTop:"auto"},closeBtn:{minWidth:120},actions:{display:"flex",justifyContent:"space-between"}},Ba=e=>{const M=e,{open:t,title:r,quiz:a,anchor:o="right",onClose:i,header:c}=M,l=O(M,["open","title","quiz","anchor","onClose","header"]),d=ye(b.QUIZZES),u=H(),{textEntity:m,actionWrapper:E,actionPanel:_}=Qa,{answerInstruction:f}=Na({kind:a.kind}),y=s.exports.useMemo(()=>a.kind===I.QuizType.QUIZ_TYPE_POW||a.kind===I.QuizType.QUIZ_TYPE_TAD,[a.kind]),v=s.exports.useMemo(()=>{const w=Array.from(a.answer.list.values());return dn(a.kind)?un(w):w},[a.answer.list,a.kind]),R=s.exports.useMemo(()=>{let w=[],k=0;return v.forEach(z=>{switch(a.kind){case I.QuizType.QUIZ_TYPE_POW:case I.QuizType.QUIZ_TYPE_TAD:case I.QuizType.QUIZ_TYPE_MCQ:case I.QuizType.QUIZ_TYPE_MAQ:{w.push(n.createElement(za,{key:k,answer:z}));break}case I.QuizType.QUIZ_TYPE_MIQ:{w.push(n.createElement(q,{key:k,displayOnly:!0,editorState:z.content}));break}case I.QuizType.QUIZ_TYPE_FIB:{w.push(n.createElement(La,{key:k,answer:z,labelType:a.answer.labelType}));break}}k++}),w},[v,a.answer.labelType,a.kind]);return n.createElement(Oa,{readOnly:!0},n.createElement(Yt,h({sx:{display:"flex",flexDirection:"column",width:450,zIndex:1300},role:"sidebar",anchor:o,open:t,onClose:i,keepMounted:!1},l),n.createElement(Y,{spacing:24,direction:"vertical",sx:Ke.wrapper,"data-testid":"QuizReview__root"},n.createElement(p,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},n.createElement(p,{sx:E,flex:1},n.createElement(W,{color:"textPrimary",sx:[V,m]},r)),n.createElement(p,{sx:_},n.createElement(tt,{size:"large",onClick:i},n.createElement(Xt,null)))),c?n.createElement(Y,{spacing:16,sx:Ke.header},n.createElement(Ue,null),n.createElement("div",null,c),n.createElement(Ue,null)):null,n.createElement(B,{container:!0,spacing:2,pb:1},n.createElement(de,{I:"show.external_id",a:"quizzes"},n.createElement(B,{item:!0,sm:6},n.createElement(X,{title:"ID",value:a.externalId,"data-testid":"QuizReview__id"})),n.createElement(B,{item:!0,sm:6})),n.createElement(B,{item:!0,sm:6},n.createElement(X,{title:d("questionType"),value:u(`resources.choices.quizTypes.${a.kind}`)})),n.createElement(de,{I:"show.difficulty",a:"quizzes"},n.createElement(B,{item:!0,sm:6},n.createElement(X,{title:d("difficultyLevel"),value:a.difficultyLevel,"data-testid":"QuizReview__difficultyLevel"}))),n.createElement(de,{I:"show.tag_lo",a:"quizzes"},n.createElement(B,{item:!0,sm:12},n.createElement(Ma,{label:u(`resources.${b.LOS}.name`),value:a.taggedLOs})))),n.createElement("div",{"data-testid":"QuizReview__description"},n.createElement(W,{sx:V},n.createElement(p,{mt:1,mb:3},d(y?"term":"questionDescription"))),n.createElement(q,{editorState:a.question.content,displayOnly:!0})),a.kind!==I.QuizType.QUIZ_TYPE_MIQ?n.createElement("div",{"data-testid":"QuizReview__answer"},f.secondary&&n.createElement(W,{sx:V},n.createElement(p,{mt:1,mb:3},d(f.secondary))),n.createElement(Y,{spacing:12},R)):null,pn(a.kind)&&n.createElement("div",{"data-testid":"QuizReview__explanation"},n.createElement(W,{sx:V},n.createElement(p,{mt:1,mb:3},d("explanation"))),n.createElement(q,{editorState:a.explanation.content,displayOnly:!0})))))};var nr=s.exports.memo(Ba);const $a=a=>{var o=a,{children:e,sx:t=[]}=o,r=O(o,["children","sx"]);return n.createElement(p,Q(h({},r),{sx:[{borderColor:"#E0E0E0"},...en(t)]}),e)},Ua={border:1,borderRadius:"4px"};$a.defaultProps=Ua;var F=(e=>(e.TEXT="TEXT",e.TEX="TEX",e.IMAGE="IMAGE",e.INLINE_TEX="INLINE_TEX",e.INLINE_IMAGE="INLINE_IMAGE",e))(F||{});const ar={addNewQuiz(e){return{type:"ADD_NEW_QUIZ",payload:e}},addNewAnswer(e={}){return{type:"ADD_NEW_ANSWER",payload:e}},changeEditorState(e){return{type:"CHANGE_EDITOR_STATE",payload:e}},changeCorrectAnswer(e,t){return{type:"CHANGE_CORRECT_ANSWER",payload:{answerId:e,correct:t}}},changeQuestionOption(e){return{type:"CHANGE_QUESTION_OPTION",payload:e}},deleteAnswer(e){return{type:"DELETE_ANSWER",payload:{answerId:e}}},deleteGroupAnswer(e){return{type:"DELETE_GROUP_ANSWER",payload:{groupKey:e}}},sendOrcRequest(e){return{type:"POST_OCR_REQUEST",payload:e}},addRectToQuestion(e){return{type:"ADD_RECT_TO_QUESTION",payload:e}},setPdfUrl(e){return{type:"SET_PDF_URL",payload:e}},setQuizOnReview(e){return{type:"SET_QUIZ_ON_REVIEW",payload:{quiz:e}}},changeLabelType(e){return{type:"CHANGE_LABEL_TYPE",payload:{labelType:e}}},clearCurrentQuiz(){return{type:"CLEAR_CURRENT_QUIZ"}},changeAnswerConfigs(e){return{type:"CHANGE_ANSWER_CONFIGS",payload:{configs:e}}},setCurrentQuiz(e){return{type:"SET_CURRENT_QUIZ",payload:{quiz:e}}},setCurrentLO(e){return{type:"SET_CURRENT_LO",payload:{lo:e}}},changeQuiz(e){return{type:"CHANGE_QUIZ",payload:{quizIndex:e}}},clearState(){return{type:"CLEAR_STATE"}},changeAnswerLabel(e,t){return{type:"CHANGE_ANSWER_LABEL",payload:{answerId:e,value:t}}},changeQuizType(e){return{type:"CHANGE_QUIZ_TYPE",payload:{quizType:e}}},requestAddNewAnswer(e){return{type:"REQUEST_ADD_NEW_ANSWER",payload:e}}};F.TEXT+"",tn,F.IMAGE+"",nn,F.TEX+"",an,F.INLINE_IMAGE+"",rn,F.INLINE_TEX+"",on;const rr=D(({quiz:e})=>e.quizzes[e.currentQuizIndex],e=>e?Array.from(e.answer.list):[]),or=D(e=>e.quiz.quizOnReview,e=>e),sr=D(({quiz:e})=>e.quizzes[e.currentQuizIndex],e=>e),ir=D(({quiz:e})=>e.lo,e=>e);D(({quiz:e})=>e.quizzes.length,e=>e);const lr=D(({quiz:e})=>e.quizzes,e=>e.every(t=>mn(t))),cr=D(({quiz:e})=>e.quizzes[e.currentQuizIndex],e=>e?e.question:null);D(({quiz:e})=>e.quizzes[e.currentQuizIndex],e=>Boolean(e));const dr=D(({quiz:e})=>e.quizzes[e.currentQuizIndex],e=>e.kind);var ve={},Fa=ne.exports;Object.defineProperty(ve,"__esModule",{value:!0});var Pa=ve.default=void 0,Ha=Fa(te),Za=ae.exports,qa=(0,Ha.default)((0,Za.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Pa=ve.default=qa;export{$a as B,ar as Q,F as R,nr as a,Pa as b,ir as c,ot as d,sr as e,lr as f,Xa as g,q as h,tr as i,cr as j,Na as k,Qa as l,Et as m,rr as n,er as o,dr as p,or as q,Sa as u};
